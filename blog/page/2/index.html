
<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<title>Squid's Blog</title>
    <meta name="author" content="Carin Meier">
    
	<meta name="description" content="Published on: Feb 1st, 2014 Tags: All, Clojure, Hitchhiker&#8217;s Guide to Clojure The following is a cautionary example of the unpredictable &hellip;">
	
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<link href="/atom.xml" rel="alternate" title="Squid's Blog" type="application/atom+xml">
	<link rel="canonical" href="">
	<link href="/favicon.ico" rel="shortcut icon">
    <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">

    <link href='http://fonts.googleapis.com/css?family=Slackey' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Fjalla+One' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Amethysta' rel='stylesheet' type='text/css'>
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
    <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

    <script type="text/javascript" src="/javascripts/jquery-tapir.js"></script>

    <!-- remove or comment it to disable ajaxification -->   
    <script src="/javascripts/ajaxify.js"></script>
   
    
    

</head>


<body>
    <div id="wrapper">
    <header id="header" class="inner"><!-- for more effects see _animate.scss -->
<h1 class="animated">
    <div id="headerbg">
        Squid's Blog
    </div>
</h1>
<br>

<ul id="social-links" style="text-align:center">
  
  
  
  
  
  
  
  
</ul>


<!-- use full url including 'index.html' for navigation bar if you are using ajax -->
<ul id="nav">
	<li id="ajax"><a href="/index.html">Home</a></li>
	<li id="ajax"><a href="/about/index.html">About</a></li>
	<li id="ajax"><a href="/speaking/index.html">Speaking</a></li>
	<li id="ajax"><a href="/blog/archives/index.html">Archives</a></li>
    <li><a href="/atom.xml">RSS</a></li>
</ul>




</header>

<div id="toload">
<!-- begin toload --> 
    <div id="content" class="inner">
        


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2014/02/01/hitchhikers-guide-to-clojure/">
		
			Hitchhiker&#8217;s Guide to Clojure</a>
	</h2>
    <div class="entry-content">
    <div class="meta">
      <div class="date">Published on: 








  


<time datetime="2014-02-01T19:33:00-05:00" pubdate data-updated="true">Feb 1<span>st</span>, 2014</time></div>
      <div class="tags">Tags: 


	<a class='category' href='/blog/categories/all/'>All</a>, <a class='category' href='/blog/categories/clojure/'>Clojure</a>, <a class='category' href='/blog/categories/hitchhikers-guide-to-clojure/'>Hitchhiker&#8217;s Guide to Clojure</a>


</div>
    </div>
		<p><img src="http://farm6.staticflickr.com/5480/12258585125_36e8fdee1e.jpg"></p>

<p><em>The following is a cautionary example of the unpredictable
combination of Clojure, a marathon viewing of the BBC&rsquo;s series &ldquo;The
Hitchhiker&rsquo;s Guide to the Galaxy&rdquo;, and a questionable amount of
cheese.</em></p>

<p>There have been many tourism guides to the
<a href="http://clojure.org/">Clojure</a> programming language.  Some that easily
come to mind for their intellectual erudition and prose are &ldquo;The Joy
of Touring Clojure&rdquo;, &ldquo;Touring Clojure&rdquo;, &ldquo;Clojure Touring&rdquo;, and the
newest edition of &ldquo;Touring Clojure Touring&rdquo;.  However, none has
surpassed the wild popularity of &ldquo;The Hitchhiker&rsquo;s Guide to Clojure&rdquo;.
It has sold over 500 million copies and has been on the &ldquo;BigInt&rsquo;s
Board of Programming Language Tourism&rdquo; for the past 15 years. While,
arguably, it
lacked the in-depth coverage of the other guides, it made up for it in
useful practical tips, such as what to do if you find a nil in your
pistachio.  Most of all, the cover had the following words printed in
very large letters: <strong>Don&rsquo;t Worry About the Parens</strong>.</p>

<p>To tell the story of the book, it is best to tell the story of two
people whose lives were affected by it: Amy Denn, one of the last
remaining <a href="http://en.wikipedia.org/wiki/Pascal_(programming_language">Pascal</a> developers in Cincinnati, and Frank Pecan, a time
traveler, guidebook reseacher, and friend of Amy.</p>

<p>Amy, at this moment, was completely unaware of the chronological
advantages of her friend, being preoccupied with the stark fact that
she was about to be fired.  She had been given a direct order from her
CEO to deploy the code at 3:05pm.  It was now 3:00pm and she had
realized that if she did so, all the data painstaking collected about
the effects of
<a href="http://en.wikipedia.org/wiki/Tuvan_throat_singing">Throat Singing</a> on
the growth rate of tomatoes would be erased. Unfortunately, the CEO
did not really understand or trust anything having to do with
technology or programming.  In truth, the only two things that he
seemed to care about were tomatoes and checklists of unreasonable
things. The fact that no course of action available to her in the next
5 minutes would help her employment situation, agitated Amy so much
that she was violently shelling and eating pistachio nuts.</p>

<p><img src="http://farm4.staticflickr.com/3331/3659226924_fbf336379e_n.jpg"></p>

<p>The &ldquo;Hitchhiker&rsquo;s Guide to Clojure&rdquo; says that
<em>pistachios are Nature&rsquo;s
most perfect <a href="http://en.wikipedia.org/wiki/S-expression">s-expression</a>. An
s-expression is recursively composed of s-expressions or an atom.
In the case of the humble pistachio, the atom is the nut inside. The
atom simply evaluates to itself.  This is best seen is an example
where the following expressions are evaluated in the Clojure
<a href="http://tryclj.com/">REPL</a></em></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="s">&quot;hi&quot;</span> <span class="c1">;;=&gt; &quot;hi&quot;</span>
</span><span class='line'><span class="mi">1</span> <span class="c1">;;=&gt; 1</span>
</span><span class='line'><span class="nv">true</span> <span class="c1">;;=&gt; true</span>
</span><span class='line'><span class="nv">nil</span> <span class="c1">;;=&gt; nil</span>
</span></code></pre></td></tr></table></div></figure>


<p>`</p>

<p><em>Which leads to the very practical tip of what to do if you find a nil
in your pistachio.  The answer, of course, is to be thankful that you
have a value that represents the absence of a value &ndash; and to get
another pistachio.</em></p>

<p><em>In Clojure, a s-expression is written with parens.  The first element
within the parens is an operator or function and the rest of the
elements are treated as data, some of which can be s-expression
themselves.</em></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="nb">+ </span><span class="mi">1</span> <span class="mi">2</span><span class="p">)</span> <span class="c1">;;=&gt; 3</span>
</span><span class='line'><span class="p">(</span><span class="nb">+ </span><span class="mi">1</span> <span class="p">(</span><span class="nb">+ </span><span class="mi">2</span> <span class="mi">2</span><span class="p">))</span> <span class="c1">;;=&gt; 5</span>
</span></code></pre></td></tr></table></div></figure>


<p><em>Considering the pistachio again, we can think of the nut in the shell
as an s-expression, (providing we also imagine an operator or function
right in front of the nut).</em></p>

<p><em>Here we define a function that will turn the nut red, by appending the
string &ldquo;red&rdquo; to the nut-name.</em></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">red</span> <span class="p">[</span><span class="nv">nut</span><span class="p">]</span>
</span><span class='line'>  <span class="p">(</span><span class="nb">str </span><span class="s">&quot;red &quot;</span> <span class="nv">nut</span><span class="p">))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="nf">red</span> <span class="s">&quot;nut1&quot;</span><span class="p">)</span> <span class="c1">;;=&gt; &quot;red nut1&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p><em>Notice that if we put a quote in front of the expression, it will no
longer be evaluated.</em></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="o">&#39;</span><span class="p">(</span><span class="nf">red</span> <span class="s">&quot;nut1&quot;</span><span class="p">)</span> <span class="c1">;;=&gt; (red &quot;nut1&quot;)</span>
</span></code></pre></td></tr></table></div></figure>


<p><em>quoting the expression turns it into a list, which we can then
manipulate with other s-expressions (code as data).</em></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="nb">first </span><span class="o">&#39;</span><span class="p">(</span><span class="nf">red</span> <span class="s">&quot;nut1&quot;</span><span class="p">))</span> <span class="c1">;;=&gt; red</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="nb">last </span><span class="o">&#39;</span><span class="p">(</span><span class="nf">red</span> <span class="s">&quot;nut1&quot;</span><span class="p">))</span> <span class="c1">;;=&gt; &quot;nut1&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p><em>If we try to evaluate the s-expression with just the nut name in the
parens, we get an error because there is no function in
the first slot.</em></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="s">&quot;nut1&quot;</span><span class="p">)</span>
</span><span class='line'><span class="c1">;;=&gt; ClassCastException java.lang.String cannot be cast to clojure.lang.IFn</span>
</span></code></pre></td></tr></table></div></figure>


<p><em>The whole thing of having to have a function in front of the nut in
the pistachio has invited much heated debate on the suitability of
pistachios being held up as the paragon of an s-expression.  But
critics have failed to explain the corroborating evidence of red
pistachio nuts, or find a more suitable nut.</em></p>

<p>Amy&rsquo;s time traveling friend, Frank, is due to appear on the scene
momentarily to reveal that the whole world is really made of Clojure
<a href="http://www.datomic.com/">Datomic</a> datoms.  Furthermore, a transaction
is going to be evaluated soon, which will retract all the facts on
EVERYTHING. The practical effect of this will be that nothing will
have an attributes. A world without any attributes at all would be
quite boring and, for all purposes, be non-existent. Luckily for Amy, Frank is a Datomic Time
Traveller and has a hand-held &ldquo;evaluator&rdquo; which will save them. Also
luckily, the readers will be spared dialog, since the author
can never figure out where to put the punctuation and is really
rubbish at it.  Only one phrase will be illustrated.  This is the
rather important one, having been uttered by Amy after it was explained to her
that she, and the entire world around her, was entirely composed of
Clojure:</p>

<p>&ldquo;Isn&rsquo;t that the language with a lot of parens?&rdquo;</p>

<p>To which, Frank handed her the &ldquo;Hitchhiker&rsquo;s Guide to Clojure&rdquo; and
pointed to the words on the front cover,  <strong>&ldquo;Don&rsquo;t Worry About the
Parens.&rdquo;</strong>, and turned to the first page.</p>

<p><em>&ldquo;There is absolutely no need to worry about the parens. It is known
 today that the first really important discovery of humankind was not
 fire, but <a href="http://www.emacswiki.org/emacs/ParEdit">Paredit</a>.  Paredit
 mode magically acts to insert and balance the right parens to the
 point where they actually can no longer be seen.  This is evident by
 just looking around you. The world is made of Clojure and there are
 millions, billions, and trillions of parens all around you and your
 tea cup right now.  Yet, you don&rsquo;t see them.  Paredit mode.&rdquo;</em></p>

<p>At the urging of Frank, Amy quickly stuffed the remaining pistachios
in her pockets while he readied his evaluator. The display showed
some large integer value, that decreased as he pushed the buttons on
the console.  Finally, he pushed the large red button and two parens
started glowing on either side of them &hellip; and they disappeared.</p>

		
		
	</div>

<div class="meta">
	
		<span class="comments"><a href="/blog/2014/02/01/hitchhikers-guide-to-clojure//blog/page/2/index.html#disqus_thread">Comments</a></span>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2014/01/09/lean-customer-interview-tips-for-the-introverted-developer/">
		
			Lean Customer Interview Tips for the Introverted Developer</a>
	</h2>
    <div class="entry-content">
    <div class="meta">
      <div class="date">Published on: 








  


<time datetime="2014-01-09T21:23:00-05:00" pubdate data-updated="true">Jan 9<span>th</span>, 2014</time></div>
      <div class="tags">Tags: 


	<a class='category' href='/blog/categories/all/'>All</a>, <a class='category' href='/blog/categories/lean/'>Lean</a>


</div>
    </div>
		<p><img src="http://farm5.staticflickr.com/4029/4356643150_9b26a637e9.jpg"></p>

<p>After attending a local Lean Startup Circle meetup, I decided to write
about some of my experiences with the
<a href="http://theleanstartup.com/">Lean Startup Methodology</a> from a software
developer&rsquo;s point of view.</p>

<h2>Why should you care about the Lean Startup Methodology?</h2>

<p>As software developer, I put my passion, honed expertise, and time
into crafting a digital product or service. One of the worst things
that can happen is that when it is released, no one uses it or wants
it. You can build a absolutely beautiful software product that scales
to the nines. But if you build the wrong thing, it is a failure.</p>

<p>The Lean Startup Methodology is basically a scientific approach to
developing business and products. You analyze your assumptions and
then devise experiments to test your hypotheses. One of the ways that
you can test them, is by talking to people and doing customer
interviews.</p>

<h2>Talking to Random People is Terrifying</h2>

<p>The prospect of talking to random people on the street is a terrifying
prospect for me as a semi-introverted software developer. It is also
incredibly useful to get out of the office and actually get feedback.
These tips come from a Lean Startup Weekend in Columbus at the Neo
office, where I successfully got
out of my comfort zone and engaged in customer interviews.</p>

<p>Background:  Our team was designing experiments around creating an app
for Food Trucks.  The fundamental assumption that we wanted to
validate was &ndash; &ldquo;People will pay money for a phone app that will tell
them where all the Food Trucks are.&rdquo;  So we headed downtown to the
local food market. This was a place where there were local artisan
food vendors in a food hall.  It seemed like an ideal place to find
people interested in good food and Food Trucks.</p>

<h3>Tip #1 &ndash; You will suck at first, but it gets better</h3>

<p>The first few people I tried to talk were complete failures. I felt
like a complete idiot. Do not get discouraged.  It helps if you go
with someone else for moral support, although you should interview
people by yourself, so they don&rsquo;t feel intimidated.</p>

<h3>Tip #2 &ndash; Have your questions written down</h3>

<p>Come prepared with the questions that you want to ask people, so you
don&rsquo;t have a brain freeze with nervousness.  However, I found I got
people to talk to me more if I didn&rsquo;t carry the pad of paper with me.
Basically anything you can do to look less like a marketer helps.</p>

<h3>Tip #3 &ndash; Tell them what you are trying to build first</h3>

<p>DO NOT START OUT LIKE THIS:  &ldquo;Can I ask you a few questions?&rdquo;
This never worked. Again, this is what a marketer would say.
I got my best responses by telling people that I was a software
developer looking to build a app for Food Trucks. In most cases, they
were happy to give advice on whether they would use the app and how
much they would pay for it.</p>

<h3>Tip #4 &ndash; Write down your results right away</h3>

<p>Memory is a fleeting thing.  Try to record the results of your
conversation right away.  Take the notepad from your pocket and go to
a corner or table and note everything down, before you forgot it all.
Also try to write down what the person said, not just your
interpretation. If someone is helping you interview, you can have one
person be a scribe, while one person talks.</p>

<h3>Tip #5 &ndash; Give Gifts</h3>

<p>If you have any funding available for this endeavor, you can get a
stack of Amazon $10 gift cards for people&rsquo;s time. This was some advice
given to us. I didn&rsquo;t actually try it for this particular outing, but
I have heard that others have used it very successfully.</p>

<h2>Getting out of your Comfort Zone is Scary but Rewarding</h2>

<p>I certainly got out of my comfort zone as a developer that weekend.
But the end result was worth it.  We ended up disproving our
hypothesis the people would pay for our app.  Almost all the people we
interviewed said that they would download the app, but no one was
willing to pay for it.  We invalidated a core assumption, it was a
success.</p>

<p>We could move on to testing and validating another idea that could be a viable business product.</p>

<p>Build things that matter.  Build well. Build the right things.</p>

<h5>Thanks to Scott Burwinkel for helping review this post for me &ndash; you rock</h5>

		
		
	</div>

<div class="meta">
	
		<span class="comments"><a href="/blog/2014/01/09/lean-customer-interview-tips-for-the-introverted-developer//blog/page/2/index.html#disqus_thread">Comments</a></span>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2013/12/26/guide-to-leaving-your-mac-laptop/">
		
			Guide to Leaving Your Mac Laptop</a>
	</h2>
    <div class="entry-content">
    <div class="meta">
      <div class="date">Published on: 








  


<time datetime="2013-12-26T00:00:00-05:00" pubdate data-updated="true">Dec 26<span>th</span>, 2013</time></div>
      <div class="tags">Tags: 


	<a class='category' href='/blog/categories/all/'>all</a>


</div>
    </div>
		<p><img src="http://farm4.staticflickr.com/3795/11572063123_6baf3b35c2.jpg"></p>

<p>I felt like I was in a controlling relationship headed downhill.
After two custom laptops returned for defective hardware, I wanted to
leave.  But leaving didn&rsquo;t seem so easy after living in the walled
garden of Apple all those years.</p>

<p>This blog post is about how to leave your Mac and return to OSS.</p>

<h2>Make a New Plan, Stan</h2>

<p>There are quite a few nice alternatives to the Mac Air out there.
I decided to go with the new
<a href="http://www.dell.com/us/business/p/xps-13-linux/pd">Sputnik 3</a>.
Some of my reasons:</p>

<ul>
<li>Powerful &ndash; New Haswell processor</li>
<li>13.3 inch touch display with 1920 x 1080 resolution</li>
<li>Ships with Ubuntu 12.04 (64 bit)</li>
<li>Nice design (yes looks are important)</li>
</ul>


<p>It arrived a couple of days before Christmas. The packaging itself
was quite nice.  Here is a picture next
to my 13 inch Mac Air.</p>

<p><img src="http://farm8.staticflickr.com/7334/11572078553_7efe0e609e.jpg"></p>

<p>The best was that everything just &ldquo;worked&rdquo; out of the box.
I had no problems configuring Ubuntu and getting the wireless network
hooked up.  I could close the lid and reopen it and have &ldquo;instant on&rdquo;
just like the Mac Air.  The keyboard is enjoyable to use and nicely
backlit.  The sleek design and light weight of the laptop is very
comparable to the Mac Air.</p>

<p><img src="http://farm4.staticflickr.com/3753/11571869965_06975d698c.jpg"></p>

<h2>Hop on the Bus, Gus</h2>

<p>It took my about a day to set up all my programs that I use on a daily
basis.
Here is a overview:</p>

<h4>Application Dock/ Organization &ndash; Dash</h4>

<p>Ubuntu has a dock on the left hand side of the screen, that is very
similar to the mac one.  You can right click and pin applications to
the dock to keep them in there. Clicking into the dash option, you can
browse your applications that are installed.</p>

<h4>Getting New Apps &ndash; Ubuntu Software Center or apt-get</h4>

<p>You can install new applications easily by using the Ubuntu Software
Center.  Browsing the applications and installing them is point and
click easy. If you don&rsquo;t see the one you need or need a more recent
version, you can always install via the command line with</p>

<pre><code>sudo apt-get install package-name
</code></pre>

<h4>Browser &ndash; Firefox or Chromium</h4>

<p>Ubuntu comes with Firefox and Chromium installed.
You can also go with Chrome of course.</p>

<h4>Mail &ndash; Thunderbird</h4>

<p>Ubuntu comes with Thunderbird mail ready to go.
I was pleasantly surprised by how easy it was to setup Thunderbird
Mail.  You simply put in your email and password.  Ubuntu keeps a
configuration list of commonly used email providers.  It automagically
figured out the correct domains and ports to use. On the downside, it
doesn&rsquo;t do anything magic with your contacts. So you are on your own
there.  I also just found out about
<a href="http://www.omgubuntu.co.uk/2013/10/geary-0-4-released-with-new-look-new-features">Geary</a>,
which looks pretty sweet.</p>

<h4>Password Management &ndash; 1 Password Anywhere + Dropbox / LastPass</h4>

<p>There is not a linux client for 1Password. I can still use it by using
<a href="http://help.agilebits.com/1Password3/1passwordanywhere.html">1PasswordAnywhere</a>.
I just have a bookmark to the 1PasswordAnyway link and I haz my
logins. I am switching over to LastPass though, so you can edit / add
new passwords. There is also an import utility to move stuff over from 1Password.</p>

<h4>Emacs</h4>

<p>Emacs just works :)
It might be just me, but I think it is happier back on Ubuntu.
I did an apt-get to get the 24 version.</p>

<h4>Git Client</h4>

<p>I went with gitg for a graphical Git client. It seems to have all the
things you need.</p>

<h4>Terminal &ndash; Byobu</h4>

<p><a href="http://byobu.co/">Byobu Terminal</a> comes already installed in Ubuntu. I have been taking
it for a test drive and really like some of the features of easily
adding new tabs, splitting screens and re-attaching to sessions.</p>

<h4>Evernote/ Everpad</h4>

<p>With
<a href="http://www.omgubuntu.co.uk/2012/09/use-evernote-in-ubuntu-with-everpad">Everpad</a>,
I can still use all my evernote stuff too.</p>

<h4>Presentations &ndash; LibreOffice / Reveal.js</h4>

<p>I have used Keynote heavily on the Mac.  For existing presentations, I
can convert them to ppt format and then modify or run in LibreOffice
Impress. Most likely with all my new presentations, I will just use a
JavaScript framework like <a href="http://lab.hakim.se/reveal-js/#/">reveal.js</a></p>

<h4>Communication &ndash; Hipchat / Skype/ Google Hangouts / Campfire</h4>

<p>We use Hipchat for messaging at work.  Hipchat has a linux client
that works just the same.  Skype also has a linux client.  Of course,
Google Hangouts is just fine on the web.  I also use Campfire
sometimes. There are a couple of linux clients out there, but I
haven&rsquo;t tried them yet.  The web version works fine for me right now.</p>

<h4>iPhone</h4>

<p>On my mac, I used to plug in my phone and sync to my dropbox.  I tried
plugging in my phone, but unfortunately, iOS7 put in a security
feature to that prevents having the phone connect properly.  The
solution for me is to just use the phone dropbox app to sync the
pictures automatically to my Dropbox.</p>

<h2>Get Yourself Free</h2>

<p>I don&rsquo;t expect the road to free of bumps.  I have only been using my
new laptop for a week.  But so far, it has been an enjoyable switch.
The hardware is really impressive, and it feels good getting back to
OSS.</p>

<p>Best of all, I set myself free.</p>

		
		
	</div>

<div class="meta">
	
		<span class="comments"><a href="/blog/2013/12/26/guide-to-leaving-your-mac-laptop//blog/page/2/index.html#disqus_thread">Comments</a></span>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2013/12/02/neural-networks-in-clojure-with-core-dot-matrix/">
		
			Neural Networks in Clojure With core.matrix</a>
	</h2>
    <div class="entry-content">
    <div class="meta">
      <div class="date">Published on: 








  


<time datetime="2013-12-02T19:28:00-05:00" pubdate data-updated="true">Dec 2<span>nd</span>, 2013</time></div>
      <div class="tags">Tags: 


	<a class='category' href='/blog/categories/all/'>All</a>, <a class='category' href='/blog/categories/clojure/'>Clojure</a>, <a class='category' href='/blog/categories/machine-learning/'>Machine Learning</a>


</div>
    </div>
		<p>After having spent some time recently looking at top-down AI, I
thought I would spend some time looking at bottom&rsquo;s up AI, machine
learning and neural networks.</p>

<p>I was pleasantly introduced to <a href="https://twitter.com/mikera">@mikea&rsquo;s</a> <a href="https://github.com/mikera/core.matrix">core.matrix</a> at Clojure Conj
this year and wanted to try making my own neural network using the
library. The purpose of this blog is to share my learnings along the
way.</p>

<h2>What is a neural network?</h2>

<p>A neural network is an approach to machine learning that involves
simulating, (in an idealized way), the way our brains work on a
biological level.  There are three layers to neural network: the input
layer, the hidden layers, and the output layer.  Each layer consists
of neurons that have a value.  In each layer, each neuron is connected to
the neuron in the next layer by a connection strength. To get data
into the neural network, you assign values to the input layer, (values
between 0 and 1). These values are then &ldquo;fed forward&rdquo; to the hidden layer neurons though an algorithm that
relies on the input values and the connection strengths. The values
are finally &ldquo;fed forward&rdquo; in a similar fashion to the output layer.
The &ldquo;learning&rdquo; portion of the neural network comes from &ldquo;training&rdquo; the
network data.  The training data consists of a collection of
associated input values and target values. The training process at a
high level looks like this:</p>

<ul>
<li>Feed forward input values to get the output values</li>
<li>How far off are the output values from the target values?</li>
<li>Calculate the error values and adjust the strengths of the network</li>
<li>Repeat until you think it has &ldquo;learned&rdquo; enough, that is when you
feed the input values in the result of the output values are close
enough to the target you are looking for</li>
</ul>


<p>The beauty of this system is that the neural network, (given the right
configuration and the right training), can approximate any function &ndash;
just by exposing it to data.</p>

<h2>Start Small</h2>

<p>I wanted to start with a very small network so that I could understand
the algorithms and actually do the maths for the tests along the way.
The network configuration I chose is one with 1 hidden layer.  The
input layer has 2 neurons, the hidden layer has 3 neurons and the
output layer has 2 neurons.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="c1">;;Neurons</span>
</span><span class='line'><span class="c1">;;  Input Hidden  Output</span>
</span><span class='line'><span class="c1">;;  A     1       C</span>
</span><span class='line'><span class="c1">;;  B     2       D</span>
</span><span class='line'><span class="c1">;;        3</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="c1">;; Connection Strengths</span>
</span><span class='line'><span class="c1">;; Input to Hidden =&gt; [[A1 A2 A3] [B1 B2 B3]]</span>
</span><span class='line'><span class="c1">;; Hidden to Output =&gt; [[1C 1D] [2C 2D] [3C 3D]]</span>
</span></code></pre></td></tr></table></div></figure>


<p>In this example we have:</p>

<ul>
<li>Input Neurons: neuronA neuronB</li>
<li>Hidden Neurons: neuron1 neuron2 neuron3</li>
<li>Output Neurons: neuronC neuronD</li>
<li>Connections between the Input and Hidden Layers

<ul>
<li>neuronA-neuron1</li>
<li>neuronA-neuron2</li>
<li>neuronA-neuron3</li>
<li>neuronB-neuron1</li>
<li>neuronB-neuron2</li>
<li>neuronB-neuron3</li>
</ul>
</li>
<li>Connections betwen the Hidden and Output Layers

<ul>
<li>neuron1-nerounC</li>
<li>neuron1-nerounD</li>
<li>neuron2-nerounC</li>
<li>neuron2-nerounD</li>
<li>neuron3-nerounC</li>
<li>neuron3-nerounD</li>
</ul>
</li>
</ul>


<p>To give us a concrete example to work with, let&rsquo;s actually assign all
our neurons and connection strengths to some real values.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="k">def </span><span class="nv">input-neurons</span> <span class="p">[</span><span class="mi">1</span> <span class="mi">0</span><span class="p">])</span>
</span><span class='line'><span class="p">(</span><span class="k">def </span><span class="nv">input-hidden-strengths</span> <span class="p">[</span> <span class="p">[</span><span class="mf">0.12</span> <span class="mf">0.2</span> <span class="mf">0.13</span><span class="p">]</span>
</span><span class='line'>                              <span class="p">[</span><span class="mf">0.01</span> <span class="mf">0.02</span> <span class="mf">0.03</span><span class="p">]])</span>
</span><span class='line'><span class="p">(</span><span class="k">def </span><span class="nv">hidden-neurons</span> <span class="p">[</span><span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span><span class="p">])</span>
</span><span class='line'><span class="p">(</span><span class="k">def </span><span class="nv">hidden-output-strengths</span> <span class="p">[[</span><span class="mf">0.15</span> <span class="mf">0.16</span><span class="p">]</span>
</span><span class='line'>                              <span class="p">[</span><span class="mf">0.02</span> <span class="mf">0.03</span><span class="p">]</span>
</span><span class='line'>                              <span class="p">[</span><span class="mf">0.01</span> <span class="mf">0.02</span><span class="p">]])</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Feed Forward</h2>

<p>Alright, we have values in the input neuron layer, let&rsquo;s feed them
forward through the network. The new value of neuron in the hidden
layer is the sum of all the inputs of its connections multiplied by
the connection strength.  The neuron can also have its own threshold,
(meaning you would subtract the threshold from the sum of inputs), but
to keep things a simple as possible in this example, the threshold is
0 &ndash; so we will ignore it.  The sum is then feed into an activation
function, that has an output in the range of -1 to 1.  The activation
function is the tanh function.  We will also need the derivative of
the tanh function a little later when we are calculating errors, so we
will define both here.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="k">def </span><span class="nv">activation-fn</span> <span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">x</span><span class="p">]</span> <span class="p">(</span><span class="nf">Math/tanh</span> <span class="nv">x</span><span class="p">)))</span>
</span><span class='line'><span class="p">(</span><span class="k">def </span><span class="nv">dactivation-fn</span> <span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">y</span><span class="p">]</span> <span class="p">(</span><span class="nb">- </span><span class="mf">1.0</span> <span class="p">(</span><span class="nb">* </span><span class="nv">y</span> <span class="nv">y</span><span class="p">))))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">layer-activation</span> <span class="p">[</span><span class="nv">inputs</span> <span class="nv">strengths</span><span class="p">]</span>
</span><span class='line'>  <span class="s">&quot;forward propagate the input of a layer&quot;</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">mapv</span> <span class="nv">activation-fn</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">mapv</span> <span class="o">#</span><span class="p">(</span><span class="nb">reduce + </span><span class="nv">%</span><span class="p">)</span>
</span><span class='line'>       <span class="p">(</span><span class="nb">* </span><span class="nv">inputs</span> <span class="p">(</span><span class="nf">transpose</span> <span class="nv">strengths</span><span class="p">)))))</span>
</span></code></pre></td></tr></table></div></figure>


<p>Note how nice core.matrix works on multipling vectors &lt;3.</p>

<p>So now if we calculate the hidden neuron values from the input [1 0],
we get:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="nf">layer-activation</span> <span class="nv">input-neurons</span> <span class="nv">input-hidden-strengths</span><span class="p">)</span>
</span><span class='line'><span class="c1">;=&gt;  [0.11942729853438588 0.197375320224904 0.12927258360605834]</span>
</span></code></pre></td></tr></table></div></figure>


<p>Let&rsquo;s just remember those hidden neuron values for our next step</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="k">def </span><span class="nv">new-hidden-neurons</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">layer-activation</span> <span class="nv">input-neurons</span> <span class="nv">input-hidden-strengths</span><span class="p">))</span>
</span></code></pre></td></tr></table></div></figure>


<p>Now we do the same thing to calculate the output values</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="nf">layer-activation</span> <span class="nv">new-hidden-neurons</span> <span class="nv">hidden-output-strengths</span><span class="p">)</span>
</span><span class='line'><span class="c1">;=&gt;  [0.02315019005321053 0.027608061500083565]</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">def </span><span class="nv">new-output-neurons</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">layer-activation</span> <span class="nv">new-hidden-neurons</span> <span class="nv">hidden-output-strengths</span><span class="p">))</span>
</span></code></pre></td></tr></table></div></figure>


<p>Alright!  We have our answer
[0.02315019005321053 0.027608061500083565].
Notice that the values are pretty much the same.  This is because we
haven&rsquo;t trained our network to do anything yet.</p>

<h2>Backwards Propagation</h2>

<p>To train our network, we have to let it know what the answer,(or
target), should be, so we can calculate the errors and finally update
our connection strengths. For this simple example, let&rsquo;s just inverse
the data &ndash; so given an input of [1 0] should give us an output of
[0 1].</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="k">def </span><span class="nv">targets</span> <span class="p">[</span><span class="mi">0</span> <span class="mi">1</span><span class="p">])</span>
</span></code></pre></td></tr></table></div></figure>


<p>`</p>

<h3>Calculate the errors of the output layer</h3>

<p>The first errors that we need to calculate are the ones for the output
layer.  This is found by subtracting the target value form the actual
value and then multiplying by the gradient/ derivative of the
activation function</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">output-deltas</span> <span class="p">[</span><span class="nv">targets</span> <span class="nv">outputs</span><span class="p">]</span>
</span><span class='line'>  <span class="s">&quot;measures the delta errors for the output layer (Desired value – actual value) and multiplying it by the gradient of the activation function&quot;</span>
</span><span class='line'>  <span class="p">(</span><span class="nb">* </span><span class="p">(</span><span class="nf">mapv</span> <span class="nv">dactivation-fn</span> <span class="nv">outputs</span><span class="p">)</span>
</span><span class='line'>     <span class="p">(</span><span class="nb">- </span><span class="nv">targets</span> <span class="nv">outputs</span><span class="p">)))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="nf">output-deltas</span> <span class="nv">targets</span> <span class="nv">new-output-neurons</span><span class="p">)</span>
</span><span class='line'><span class="c1">;=&gt; [-0.023137783141771645 0.9716507764442904]</span>
</span></code></pre></td></tr></table></div></figure>


<p>`</p>

<p>Great let&rsquo;s remember this output deltas for later</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="k">def </span><span class="nv">odeltas</span> <span class="p">(</span><span class="nf">output-deltas</span> <span class="nv">targets</span> <span class="nv">new-output-neurons</span><span class="p">))</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Calculate the errors of the hidden layer</h3>

<p>The errors of the hidden layer are based off the deltas that we just
found from the output layer.  In fact, for each hidden neuron, the
error delta is the gradient of the activation function multiplied by
the weighted sum of the ouput deltas of connected ouput neurons and
it&rsquo;s connection strength.  This should remind you of the forward
propagation of the inputs &ndash; but this time we are doing it backwards
with the error deltas.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">hlayer-deltas</span> <span class="p">[</span><span class="nv">odeltas</span> <span class="nv">neurons</span> <span class="nv">strengths</span><span class="p">]</span>
</span><span class='line'>  <span class="p">(</span><span class="nb">* </span><span class="p">(</span><span class="nf">mapv</span> <span class="nv">dactivation-fn</span> <span class="nv">neurons</span><span class="p">)</span>
</span><span class='line'>     <span class="p">(</span><span class="nf">mapv</span> <span class="o">#</span><span class="p">(</span><span class="nb">reduce + </span><span class="nv">%</span><span class="p">)</span>
</span><span class='line'>           <span class="p">(</span><span class="nb">* </span><span class="nv">odeltas</span> <span class="nv">strengths</span><span class="p">))))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="nf">hlayer-deltas</span>
</span><span class='line'>    <span class="nv">odeltas</span>
</span><span class='line'>    <span class="nv">new-hidden-neurons</span>
</span><span class='line'>    <span class="nv">hidden-output-strengths</span><span class="p">)</span>
</span><span class='line'><span class="c1">;=&gt;  [0.14982559238071416 0.027569216735265096 0.018880751432503236]</span>
</span></code></pre></td></tr></table></div></figure>


<p>Great let&rsquo;s remember the hidden layer error deltas for later</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="k">def </span><span class="nv">hdeltas</span> <span class="p">(</span><span class="nf">hlayer-deltas</span>
</span><span class='line'>              <span class="nv">odeltas</span>
</span><span class='line'>              <span class="nv">new-hidden-neurons</span>
</span><span class='line'>              <span class="nv">hidden-output-strengths</span><span class="p">))</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Updating the connection strengths</h3>

<p>Great!  We have all the error deltas, now we are ready to go ahead and
update the connection strengths.  In general this is the same process
for both the hidden-output connections and the input-hidden
connections.</p>

<ul>
<li>weight-change = error-delta * neuron-value</li>
<li>new-weight = weight + learning rate * weight-change</li>
</ul>


<p>The learning rate controls how fast the weigths and errors should be
adjusted.  It the learning rate is too high, then there is the danger
that it will converge to fit the solution too fast and not find the
best solution.  If the learning rate is too low, it may never actually
converge to the right solution given the training data that it is
using. For this example, let&rsquo;s use a training rate of 0.2</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">update-strengths</span> <span class="p">[</span><span class="nv">deltas</span> <span class="nv">neurons</span> <span class="nv">strengths</span> <span class="nv">lrate</span><span class="p">]</span>
</span><span class='line'>  <span class="p">(</span><span class="nb">+ </span><span class="nv">strengths</span> <span class="p">(</span><span class="nb">* </span><span class="nv">lrate</span>
</span><span class='line'>                  <span class="p">(</span><span class="nf">mapv</span> <span class="o">#</span><span class="p">(</span><span class="nb">* </span><span class="nv">deltas</span> <span class="nv">%</span><span class="p">)</span> <span class="nv">neurons</span><span class="p">))))</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Update the hidden-output strengths</h3>

<p>Updating this layer we are going to look at</p>

<ul>
<li>weight-change = odelta * hidden value</li>
<li>new-weight = weight + (learning rate * weight-change)</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="nf">update-strengths</span>
</span><span class='line'>       <span class="nv">odeltas</span>
</span><span class='line'>       <span class="nv">new-hidden-neurons</span>
</span><span class='line'>       <span class="nv">hidden-output-strengths</span>
</span><span class='line'>       <span class="nv">learning-rate</span><span class="p">)</span>
</span><span class='line'><span class="c1">;=&gt; [[0.14944734341306073 0.18320832546991603]</span>
</span><span class='line'>    <span class="p">[</span><span class="mf">0.019086634528619688</span> <span class="mf">0.06835597662949369</span><span class="p">]</span>
</span><span class='line'>    <span class="p">[</span><span class="mf">0.009401783798869296</span> <span class="mf">0.04512156124675721</span><span class="p">]]</span>
</span></code></pre></td></tr></table></div></figure>


<p>Of course, let&rsquo;s remember these values too</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="k">def </span><span class="nv">new-hidden-output-strengths</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">update-strengths</span>
</span><span class='line'>       <span class="nv">odeltas</span>
</span><span class='line'>       <span class="nv">new-hidden-neurons</span>
</span><span class='line'>       <span class="nv">hidden-output-strengths</span>
</span><span class='line'>       <span class="nv">learning-rate</span><span class="p">))</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Update the input-hidden strengths</h3>

<p>We are going to do the same thing with the input-hidden strengths too.</p>

<ul>
<li>weight-change = hdelta * input value</li>
<li>new-weight = weight + (learning rate * weight-change)</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'> <span class="p">(</span><span class="nf">update-strengths</span>
</span><span class='line'>           <span class="nv">hdeltas</span>
</span><span class='line'>           <span class="nv">input-neurons</span>
</span><span class='line'>           <span class="nv">input-hidden-strengths</span>
</span><span class='line'>           <span class="nv">learning-rate</span><span class="p">)</span>
</span><span class='line'><span class="c1">;=&gt;  [[0.14996511847614283 0.20551384334705303 0.13377615028650064]</span>
</span><span class='line'>           <span class="p">[</span><span class="mf">0.01</span> <span class="mf">0.02</span> <span class="mf">0.03</span><span class="p">]]</span>
</span></code></pre></td></tr></table></div></figure>


<p>These are our new strengths</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="k">def </span><span class="nv">new-input-hidden-strengths</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">update-strengths</span>
</span><span class='line'>       <span class="nv">hdeltas</span>
</span><span class='line'>       <span class="nv">input-neurons</span>
</span><span class='line'>       <span class="nv">input-hidden-strengths</span>
</span><span class='line'>       <span class="nv">learning-rate</span><span class="p">))</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Putting the pieces together</h2>

<p>We have done it!  In our simple example we have:</p>

<ul>
<li>Forward propagated the input to get the output</li>
<li>Calculated the errors from the target through backpropogation</li>
<li>Updated the connection strengths/ weights</li>
</ul>


<p>We just need to put all the pieces together. We&rsquo;ll do this with the
values that we got earlier to make sure it is all working.</p>

<h3>Construct a network representation</h3>

<p>It would be nice if we could represent an entire neural network in a
data structure.  That way the whole transformation of feeding forward
and training the network could give us a new network back.
So lets define the data structure as
[input-neurons input-hidden-strengths hidden-neurons hidden-output-strengths output-neurons].</p>

<p>We will start off with all the values of the neurons being zero.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="k">def </span><span class="nv">nn</span> <span class="p">[</span> <span class="p">[</span><span class="mi">0</span> <span class="mi">0</span><span class="p">]</span> <span class="nv">input-hidden-strengths</span> <span class="nv">hidden-neurons</span>
</span><span class='line'><span class="nv">hidden-output-strengths</span> <span class="p">[</span><span class="mi">0</span> <span class="mi">0</span><span class="p">]])</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Generalized feed forward</h3>

<p>Now we can make a feed forward function that takes this network and
constructs a new network based on input values and the
layer-activation function that we defined earlier.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">feed-forward</span> <span class="p">[</span><span class="nv">input</span> <span class="nv">network</span><span class="p">]</span>
</span><span class='line'>  <span class="p">(</span><span class="k">let </span><span class="p">[[</span><span class="nv">in</span> <span class="nv">i-h-strengths</span> <span class="nv">h</span> <span class="nv">h-o-strengths</span> <span class="nv">out</span><span class="p">]</span> <span class="nv">network</span>
</span><span class='line'>        <span class="nv">new-h</span> <span class="p">(</span><span class="nf">layer-activation</span> <span class="nv">input</span> <span class="nv">i-h-strengths</span><span class="p">)</span>
</span><span class='line'>        <span class="nv">new-o</span> <span class="p">(</span><span class="nf">layer-activation</span> <span class="nv">new-h</span> <span class="nv">h-o-strengths</span><span class="p">)]</span>
</span><span class='line'>    <span class="p">[</span><span class="nv">input</span> <span class="nv">i-h-strengths</span> <span class="nv">new-h</span> <span class="nv">h-o-strengths</span> <span class="nv">new-o</span><span class="p">]))</span>
</span></code></pre></td></tr></table></div></figure>


<p>This should match up with the values that we got earlier when we were
just working on the individual pieces.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="nf">testing</span> <span class="s">&quot;feed forward&quot;</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">is</span> <span class="p">(</span><span class="nb">== </span><span class="p">[</span><span class="nv">input-neurons</span> <span class="nv">input-hidden-strengths</span> <span class="nv">new-hidden-neurons</span> <span class="nv">hidden-output-strengths</span> <span class="nv">new-output-neurons</span><span class="p">]</span>
</span><span class='line'>          <span class="p">(</span><span class="nf">feed-forward</span> <span class="p">[</span><span class="mi">1</span> <span class="mi">0</span><span class="p">]</span> <span class="nv">nn</span><span class="p">))))</span>
</span></code></pre></td></tr></table></div></figure>


<p>`</p>

<h3>Generalized update weights / connection strengths</h3>

<p>We can make a similiar update-weights function that calculate the
errors and returns back a new network with the updated weights</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">update-weights</span> <span class="p">[</span><span class="nv">network</span> <span class="nv">target</span> <span class="nv">learning-rate</span><span class="p">]</span>
</span><span class='line'>  <span class="p">(</span><span class="k">let </span><span class="p">[[</span> <span class="nv">in</span> <span class="nv">i-h-strengths</span> <span class="nv">h</span> <span class="nv">h-o-strengths</span> <span class="nv">out</span><span class="p">]</span> <span class="nv">network</span>
</span><span class='line'>        <span class="nv">o-deltas</span> <span class="p">(</span><span class="nf">output-deltas</span> <span class="nv">target</span> <span class="nv">out</span><span class="p">)</span>
</span><span class='line'>        <span class="nv">h-deltas</span> <span class="p">(</span><span class="nf">hlayer-deltas</span> <span class="nv">o-deltas</span> <span class="nv">h</span> <span class="nv">h-o-strengths</span><span class="p">)</span>
</span><span class='line'>        <span class="nv">n-h-o-strengths</span> <span class="p">(</span><span class="nf">update-strengths</span>
</span><span class='line'>                         <span class="nv">o-deltas</span>
</span><span class='line'>                         <span class="nv">h</span>
</span><span class='line'>                         <span class="nv">h-o-strengths</span>
</span><span class='line'>                         <span class="nv">learning-rate</span><span class="p">)</span>
</span><span class='line'>        <span class="nv">n-i-h-strengths</span> <span class="p">(</span><span class="nf">update-strengths</span>
</span><span class='line'>                         <span class="nv">h-deltas</span>
</span><span class='line'>                         <span class="nv">in</span>
</span><span class='line'>                         <span class="nv">i-h-strengths</span>
</span><span class='line'>                         <span class="nv">learning-rate</span><span class="p">)]</span>
</span><span class='line'>    <span class="p">[</span><span class="nv">in</span> <span class="nv">n-i-h-strengths</span> <span class="nv">h</span> <span class="nv">n-h-o-strengths</span> <span class="nv">out</span><span class="p">]))</span>
</span></code></pre></td></tr></table></div></figure>


<p>This too should match up with the pieces from the earlier examples.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="nf">testing</span> <span class="s">&quot;update-weights&quot;</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">is</span> <span class="p">(</span> <span class="nb">== </span><span class="p">[</span><span class="nv">input-neurons</span>
</span><span class='line'>            <span class="nv">new-input-hidden-strengths</span>
</span><span class='line'>            <span class="nv">new-hidden-neurons</span>
</span><span class='line'>            <span class="nv">new-hidden-output-strengths</span>
</span><span class='line'>            <span class="nv">new-output-neurons</span><span class="p">]</span>
</span><span class='line'>           <span class="p">(</span><span class="nf">update-weights</span> <span class="p">(</span><span class="nf">feed-forward</span> <span class="p">[</span><span class="mi">1</span> <span class="mi">0</span><span class="p">]</span> <span class="nv">nn</span><span class="p">)</span> <span class="p">[</span><span class="mi">0</span> <span class="mi">1</span><span class="p">]</span> <span class="mf">0.2</span><span class="p">))))</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Generalized train network</h3>

<p>Now we can make a function that takes input and a target and feeds the
input forward and then updates the weights.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">train-network</span> <span class="p">[</span><span class="nv">network</span> <span class="nv">input</span> <span class="nv">target</span> <span class="nv">learning-rate</span><span class="p">]</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">update-weights</span> <span class="p">(</span><span class="nf">feed-forward</span> <span class="nv">input</span> <span class="nv">network</span><span class="p">)</span> <span class="nv">target</span> <span class="nv">learning-rate</span><span class="p">))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="nf">testing</span> <span class="s">&quot;train-network&quot;</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">is</span> <span class="p">(</span><span class="nb">== </span><span class="p">[</span><span class="nv">input-neurons</span>
</span><span class='line'>            <span class="nv">new-input-hidden-strengths</span>
</span><span class='line'>            <span class="nv">new-hidden-neurons</span>
</span><span class='line'>            <span class="nv">new-hidden-output-strengths</span>
</span><span class='line'>           <span class="nv">new-output-neurons</span><span class="p">]</span>
</span><span class='line'>          <span class="p">(</span><span class="nf">train-network</span> <span class="nv">nn</span> <span class="p">[</span><span class="mi">1</span> <span class="mi">0</span><span class="p">]</span> <span class="p">[</span><span class="mi">0</span> <span class="mi">1</span><span class="p">]</span> <span class="mf">0.2</span><span class="p">))))</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Try it out!</h2>

<p>We are ready to try it out!  Let&rsquo;s train our network on a few examples
of inversing the data</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="k">def </span><span class="nv">n1</span> <span class="p">(</span><span class="nb">-&gt; </span><span class="nv">nn</span>
</span><span class='line'>     <span class="p">(</span><span class="nf">train-network</span> <span class="p">[</span><span class="mi">1</span> <span class="mi">0</span><span class="p">]</span> <span class="p">[</span><span class="mi">0</span> <span class="mi">1</span><span class="p">]</span> <span class="mf">0.5</span><span class="p">)</span>
</span><span class='line'>     <span class="p">(</span><span class="nf">train-network</span> <span class="p">[</span><span class="mf">0.5</span> <span class="mi">0</span><span class="p">]</span> <span class="p">[</span><span class="mi">0</span> <span class="mf">0.5</span><span class="p">]</span> <span class="mf">0.5</span><span class="p">)</span>
</span><span class='line'>     <span class="p">(</span><span class="nf">train-network</span> <span class="p">[</span><span class="mf">0.25</span> <span class="mi">0</span><span class="p">]</span> <span class="p">[</span><span class="mi">0</span> <span class="mf">0.25</span><span class="p">]</span> <span class="mf">0.5</span><span class="p">)))</span>
</span></code></pre></td></tr></table></div></figure>


<p>We&rsquo;ll also make a helper function that just returns the output
neurons for the feed-forward function.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">ff</span> <span class="p">[</span><span class="nv">input</span> <span class="nv">network</span><span class="p">]</span>
</span><span class='line'>  <span class="p">(</span><span class="nb">last </span><span class="p">(</span><span class="nf">feed-forward</span> <span class="nv">input</span> <span class="nv">network</span><span class="p">)))</span>
</span></code></pre></td></tr></table></div></figure>


<p>Let&rsquo;s look at the results of the untrained and the trained networks</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="c1">;;untrained</span>
</span><span class='line'><span class="p">(</span><span class="nf">ff</span> <span class="p">[</span><span class="mi">1</span> <span class="mi">0</span><span class="p">]</span> <span class="nv">nn</span><span class="p">)</span> <span class="c1">;=&gt; [0.02315019005321053 0.027608061500083565]</span>
</span><span class='line'><span class="c1">;;trained</span>
</span><span class='line'><span class="p">(</span><span class="nf">ff</span> <span class="p">[</span><span class="mi">1</span> <span class="mi">0</span><span class="p">]</span> <span class="nv">n1</span><span class="p">)</span> <span class="c1">;=&gt; [0.03765676393050254 0.10552175312900794]</span>
</span></code></pre></td></tr></table></div></figure>


<p>Whoa!  The trained example isn&rsquo;t perfect, but we can see that it is
getting closer to the right answer.  It is learning!</p>

<h2>MOR Training Data</h2>

<p>Well this is really cool and it is working.  But it would be nicer to
be able to present a set of training data for it to learn on.  For
example, it would be nice to have a training data structure look like:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">[</span> <span class="p">[</span><span class="nv">input</span> <span class="nv">target</span><span class="p">]</span> <span class="p">[</span><span class="nv">input</span> <span class="nv">target</span><span class="p">]</span> <span class="nv">...</span> <span class="p">]</span>
</span></code></pre></td></tr></table></div></figure>


<p>Let&rsquo;s go ahead and define that.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">train-data</span> <span class="p">[</span><span class="nv">network</span> <span class="nv">data</span> <span class="nv">learning-rate</span><span class="p">]</span>
</span><span class='line'>  <span class="p">(</span><span class="nb">if-let </span><span class="p">[[</span><span class="nv">input</span> <span class="nv">target</span><span class="p">]</span> <span class="p">(</span><span class="nb">first </span><span class="nv">data</span><span class="p">)]</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">recur</span>
</span><span class='line'>     <span class="p">(</span><span class="nf">train-network</span> <span class="nv">network</span> <span class="nv">input</span> <span class="nv">target</span> <span class="nv">learning-rate</span><span class="p">)</span>
</span><span class='line'>     <span class="p">(</span><span class="nb">rest </span><span class="nv">data</span><span class="p">)</span>
</span><span class='line'>     <span class="nv">learning-rate</span><span class="p">)</span>
</span><span class='line'>    <span class="nv">network</span><span class="p">))</span>
</span></code></pre></td></tr></table></div></figure>


<p>Let&rsquo;s try that out on the example earlier</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="k">def </span><span class="nv">n2</span> <span class="p">(</span><span class="nf">train-data</span> <span class="nv">nn</span> <span class="p">[</span>
</span><span class='line'>                        <span class="p">[[</span><span class="mi">1</span> <span class="mi">0</span><span class="p">]</span> <span class="p">[</span><span class="mi">0</span> <span class="mi">1</span><span class="p">]]</span>
</span><span class='line'>                        <span class="p">[[</span><span class="mf">0.5</span> <span class="mi">0</span><span class="p">]</span> <span class="p">[</span><span class="mi">0</span> <span class="mf">0.5</span><span class="p">]]</span>
</span><span class='line'>                        <span class="p">[[</span><span class="mf">0.25</span> <span class="mi">0</span><span class="p">]</span> <span class="p">[</span><span class="mi">0</span> <span class="mf">0.25</span><span class="p">]</span> <span class="p">]</span>
</span><span class='line'>                        <span class="p">]</span>
</span><span class='line'>                    <span class="mf">0.5</span><span class="p">))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="nf">ff</span> <span class="p">[</span><span class="mi">1</span> <span class="mi">0</span><span class="p">]</span> <span class="nv">n2</span><span class="p">)</span> <span class="c1">;=&gt; [0.03765676393050254 0.10552175312900794]</span>
</span></code></pre></td></tr></table></div></figure>


<p>Cool. We can now train on data sets. That means we can construct data
sets out of infinite lazy sequences too.  Let&rsquo;s make a lazy training
set of inputs and their inverse.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">inverse-data</span> <span class="p">[]</span>
</span><span class='line'>  <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">n</span> <span class="p">(</span><span class="nb">rand </span><span class="mi">1</span><span class="p">)]</span>
</span><span class='line'>    <span class="p">[[</span><span class="nv">n</span> <span class="mi">0</span><span class="p">]</span> <span class="p">[</span><span class="mi">0</span> <span class="nv">n</span><span class="p">]]))</span>
</span></code></pre></td></tr></table></div></figure>


<p>Let&rsquo;s see how well our network is doing after we train it with some
more data</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="k">def </span><span class="nv">n3</span> <span class="p">(</span><span class="nf">train-data</span> <span class="nv">nn</span> <span class="p">(</span><span class="nf">repeatedly</span> <span class="mi">400</span> <span class="nv">inverse-data</span><span class="p">)</span> <span class="mf">0.5</span><span class="p">))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="nf">ff</span> <span class="p">[</span><span class="mi">1</span> <span class="mi">0</span><span class="p">]</span> <span class="nv">n3</span><span class="p">)</span> <span class="c1">;=&gt; [-4.958278484025221E-4 0.8211647699205362]</span>
</span><span class='line'><span class="p">(</span><span class="nf">ff</span> <span class="p">[</span><span class="mf">0.5</span> <span class="mi">0</span><span class="p">]</span> <span class="nv">n3</span><span class="p">)</span> <span class="c1">;=&gt; [2.1645760787874696E-4 0.5579396715416916]</span>
</span><span class='line'><span class="p">(</span><span class="nf">ff</span> <span class="p">[</span><span class="mf">0.25</span> <span class="mi">0</span><span class="p">]</span> <span class="nv">n3</span><span class="p">)</span> <span class="c1">;=&gt; [1.8183385523103048E-4 0.31130601296149013]</span>
</span></code></pre></td></tr></table></div></figure>


<p>Wow. The more examples it sees, the better that network is doing at
learning what to do!</p>

<h3>General Construct Network</h3>

<p>The only piece that we are missing now is to have a function that will
create a general neural network for us.  We can choose how many input
nerurons, hidden neurons, and output neurons and have a network
constructed with random weights.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">gen-strengths</span> <span class="p">[</span><span class="nv">to</span> <span class="nv">from</span><span class="p">]</span>
</span><span class='line'>  <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">l</span> <span class="p">(</span><span class="nb">* </span><span class="nv">to</span> <span class="nv">from</span><span class="p">)]</span>
</span><span class='line'>    <span class="p">(</span><span class="nb">map </span><span class="nv">vec</span> <span class="p">(</span><span class="nf">partition</span> <span class="nv">from</span> <span class="p">(</span><span class="nf">repeatedly</span> <span class="nv">l</span> <span class="o">#</span><span class="p">(</span><span class="nb">rand </span><span class="p">(</span><span class="nb">/ </span><span class="mi">1</span> <span class="nv">l</span><span class="p">)))))))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">construct-network</span> <span class="p">[</span><span class="nv">num-in</span> <span class="nv">num-hidden</span> <span class="nv">num-out</span><span class="p">]</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">vec</span> <span class="p">(</span><span class="nb">map </span><span class="nv">vec</span> <span class="p">[(</span><span class="nb">repeat </span><span class="nv">num-in</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'>             <span class="p">(</span><span class="nf">gen-strengths</span> <span class="nv">num-in</span> <span class="nv">num-hidden</span><span class="p">)</span>
</span><span class='line'>             <span class="p">(</span><span class="nb">repeat </span><span class="nv">num-hidden</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'>             <span class="p">(</span><span class="nf">gen-strengths</span> <span class="nv">num-hidden</span> <span class="nv">num-out</span><span class="p">)</span>
</span><span class='line'>             <span class="p">(</span><span class="nb">repeat </span><span class="nv">num-out</span> <span class="mi">0</span><span class="p">)])))</span>
</span></code></pre></td></tr></table></div></figure>


<p>Now we can construct our network from scratch and train it.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="k">def </span><span class="nv">tnn</span> <span class="p">(</span><span class="nf">construct-network</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">2</span><span class="p">))</span>
</span><span class='line'><span class="p">(</span><span class="k">def </span><span class="nv">n5</span> <span class="p">(</span><span class="nf">train-data</span> <span class="nv">tnn</span> <span class="p">(</span><span class="nf">repeatedly</span> <span class="mi">1000</span> <span class="nv">inverse-data</span><span class="p">)</span> <span class="mf">0.2</span><span class="p">))</span>
</span><span class='line'><span class="p">(</span><span class="nf">ff</span> <span class="p">[</span><span class="mi">1</span> <span class="mi">0</span><span class="p">]</span> <span class="nv">n4</span><span class="p">)</span> <span class="c1">;=&gt; [-4.954958580800465E-4 0.8160149309699489]</span>
</span></code></pre></td></tr></table></div></figure>


<p>And that&rsquo;s it.  We have constucted a neural network with core.matrix</p>

<h2>Want more?</h2>

<p>I put together a github library based on the neural network code in
the posts.  It is called <a href="https://github.com/gigasquid/k9">K9</a>, named
after Dr. Who&rsquo;s best dog friend.  You can find the examples we have
gone through in the tests.  There is also an example program using it
in the examples directory.  It learns what colors are based on thier
RGB value.</p>

<p>There are a couple web resources I would recommend if you want to look
farther as well.</p>

<ul>
<li><a href="http://takinginitiative.wordpress.com/2008/04/03/basic-neural-network-tutorial-theory/">Basic Network Tutorial</a></li>
<li><a href="http://www.youtube.com/watch?v=QJ1qgCr09j8&amp;feature=player_embedded">Mike Anderson&rsquo;s Clojure Conj talk on Neural Networks</a></li>
</ul>


<p>Go forth and create Neural Networks!</p>

		
		
	</div>

<div class="meta">
	
		<span class="comments"><a href="/blog/2013/12/02/neural-networks-in-clojure-with-core-dot-matrix//blog/page/2/index.html#disqus_thread">Comments</a></span>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2013/11/02/embrace-and-reach/">
		
			Embrace and Reach</a>
	</h2>
    <div class="entry-content">
    <div class="meta">
      <div class="date">Published on: 








  


<time datetime="2013-11-02T14:51:00-04:00" pubdate data-updated="true">Nov 2<span>nd</span>, 2013</time></div>
      <div class="tags">Tags: 


	<a class='category' href='/blog/categories/all/'>All</a>, <a class='category' href='/blog/categories/development/'>Development</a>, <a class='category' href='/blog/categories/technology/'>Technology</a>


</div>
    </div>
		<p><img src="http://farm1.staticflickr.com/99/290760357_01392a3f51_n.jpg"></p>

<p>One of the wonderful things about being a technologist today, is
to be part of an industry that is bubbling over with new and
exciting things. It can be exhilarating and overwhelming. How can we
try and do all these great new things?  Of course, it is not
sensible to simply drop whatever you are using and continually chase
after the newest tech.  Nor is steadfastly staying in one place and
refusing to accept that there is a better way of doing things.  The
challenge is to absorb, identify, and synthesize both good of the
what we are currently doing and the new stuff too.  We want to embrace and continue the good things that
are working for us and reach for the new technologies that will propel
us farther in the future.</p>

<p>Since everyone has their own experience synthesizing the world around
them, there are many differing opinions on what we should continue to
embrace and what we technologies and practices should reach for.  I
humbly offer my thoughts on this based from my own perspective.</p>

<h2>Embrace: Agile Feedback</h2>

<h2>Reach for: Lean Startup Discipline and Programmer Anarchy</h2>

<p>Agile has become a victim of its own success.  Becoming so big, its
message has been confused and abused in too many ways to name.  But
the core pillar of frequent and continuous feedback is a foundation to
any successful software project and should be embraced.  However, we
should not stop there.  We should reach for the rewards that <a href="http://theleanstartup.com/principles">Lean Startup
Methodology</a> offers in the form
of displinced validation.  We should also
reach to unleash the innovation of our smart developers with
<a href="http://www.youtube.com/watch?v=uk-CF7klLdA">Programmer Anarchy</a>, and
look for ways to ruthlessly stomp out unnecessary and wasteful
project management practices.</p>

<h2>Embrace: Ruby&rsquo;s Community</h2>

<h2>Reach for: Clojure, Go, Elixir, and Meteor</h2>

<p>Ruby and Rails have been an incredible game changer for web
development.  But they too are suffering from their own success.  One
of the strengths of Ruby, which should be embraced and nutured, is the
strength of the community and the openness to newcomers.  This strength
yields a fruitful ground for a vibrant library ecosystem, which has
helped Ruby flourish.  We need to reach beyond Ruby and Rails to other
languages and frameworks that focus on simplicity and concurrency.  The bright future
will belong to the likes of <a href="http://clojure.org/">Clojure</a>,
<a href="http://golang.org/">Go</a>, <a href="http://elixir-lang.org/">Elixir</a>, and <a href="http://www.meteor.com/">Meteor</a>.  We need
to reach and start using these in the products we build, while
encouraging the growth of a welcoming community and ecosystem like the
one we have in Ruby.</p>

<h2>Embrace: Collaboration</h2>

<h2>Reach for: the Distributed and Decentralized</h2>

<p>Collaboration with tools like Google Docs works.  We should continue
to embrace the power that this gives us. However we should embrace
tools for combining this collaboration in a truly distributed and
decentralized manner. Git itself is wonderful and distributed, but we
should reach for tools like Github to be more decentralized and resilient.
As privacy concerns grow in today&rsquo;s world.  We need to reach beyond
the convenience that a centralized source of information gives us and
truly understand the trade offs involved.</p>

<p>We live in an incredible, vibrant time.  Look around and what you
do everyday.  Embrace and nurture all the good parts, and never give up
reaching for something better.</p>

		
		
	</div>

<div class="meta">
	
		<span class="comments"><a href="/blog/2013/11/02/embrace-and-reach//blog/page/2/index.html#disqus_thread">Comments</a></span>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2013/10/03/looking-forward-to-london/">
		
			Looking Forward to London</a>
	</h2>
    <div class="entry-content">
    <div class="meta">
      <div class="date">Published on: 








  


<time datetime="2013-10-03T20:43:00-04:00" pubdate data-updated="true">Oct 3<span>rd</span>, 2013</time></div>
      <div class="tags">Tags: 


	<a class='category' href='/blog/categories/all/'>All</a>, <a class='category' href='/blog/categories/clojure/'>Clojure</a>, <a class='category' href='/blog/categories/speaking/'>Speaking</a>


</div>
    </div>
		<p>I really love the London.  I have only been once many years ago,
but I was enchanted.  Here is a partial list of my favorite
things:</p>

<ul>
<li>Ducks in Regent&rsquo;s Park</li>
<li>Tea Rooms</li>
<li>The Food Hall at Harrod&rsquo;s</li>
<li>The British Museum</li>
<li>English Breakfasts</li>
<li>The way the British put an extra &ldquo;r&rdquo; in phrases like &ldquo;vanilla in it&rdquo;</li>
</ul>


<p>As you know, I also adore Clojure. So I am absolutely thrilled to combine the two.</p>

<h2>Clojure eXchange</h2>

<p>I will be speaking at the
<a href="http://skillsmatter.com/event/java-jee/clojure-exchange-2013">Clojure eXchange conference</a>
on December 6th.  The talk is a bit odd, (like me), and will have
Clojure, parsers, sea monsters, philosophy, and an AR Drone in it.  It
should be a lot of fun.</p>

<p>I really looking forward to get a chance to meet the London Clojure
community in person. Hope to see you there.</p>

<p>P.S. If anyone has any tips on flying overseas with an AR Drone.
Please let me know :)</p>

		
		
	</div>

<div class="meta">
	
		<span class="comments"><a href="/blog/2013/10/03/looking-forward-to-london//blog/page/2/index.html#disqus_thread">Comments</a></span>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2013/09/05/controlling-multiple-drones-with-clojure-and-goals-and-beliefs/">
		
			Controlling Multiple Drones With Clojure and Goals and Beliefs</a>
	</h2>
    <div class="entry-content">
    <div class="meta">
      <div class="date">Published on: 








  


<time datetime="2013-09-05T15:35:00-04:00" pubdate data-updated="true">Sep 5<span>th</span>, 2013</time></div>
      <div class="tags">Tags: 


	<a class='category' href='/blog/categories/ar-drones/'>AR Drones</a>, <a class='category' href='/blog/categories/all/'>All</a>, <a class='category' href='/blog/categories/clojure/'>Clojure</a>, <a class='category' href='/blog/categories/development/'>Development</a>


</div>
    </div>
		<h2>How to Control Multiple Drones with Clojure</h2>

<p>The <a href="https://github.com/gigasquid/clj-drone">clj-drone</a> library now
has multi-drone support!  You can now send multiple drones commands,
receive their navigation data, and even have them perform their
actions autonomously with goals and beliefs.</p>

<p>It takes a bit of extra setup to control more than one drone. We need to assign them each an
ip and get them talking as an adhoc network.
<a href="https://twitter.com/jimweirich">Jim Weirich</a> creating a neat little
script to run on the drone to do just this.  Here are the
instructions:</p>

<h3>Change first drone to adhoc network</h3>

<p>Connect your computer to the first drone&rsquo;s network.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="nv">telnet</span> <span class="mf">192.68</span><span class="nv">.1.1</span>
</span></code></pre></td></tr></table></div></figure>


<p>`</p>

<p>Create the following file as adhoc.sh.  This shell script will
temporarily change the network to an adhoc network named
&ldquo;multidrone_ah&rdquo; and assign it a static ip of 192.168.1.100.
The next time you reboot your drone, things will be back to normal.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="c1">; This script should be run on the drone.</span>
</span><span class='line'><span class="c1">; Change the IP address to be difference</span>
</span><span class='line'><span class="c1">; for each drone on the same ad-hoc network</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="nv">killall</span> <span class="nv">udhcpd</span>
</span><span class='line'><span class="nv">ifconfig</span> <span class="nv">ath0</span> <span class="nv">down</span>
</span><span class='line'><span class="nv">iwconfig</span> <span class="nv">ath0</span> <span class="nv">mode</span> <span class="nv">ad-hoc</span> <span class="nv">essid</span> <span class="nv">multidrone_ah</span> <span class="nv">channel</span> <span class="nv">auto</span> <span class="nv">commit</span>
</span><span class='line'><span class="nv">ifconfig</span> <span class="nv">ath0</span> <span class="mf">192.168</span><span class="nv">.1.100</span> <span class="nv">netmask</span> <span class="mf">255.255</span><span class="nv">.255.0</span> <span class="nv">up</span>
</span></code></pre></td></tr></table></div></figure>


<p>`</p>

<p>Run the script.</p>

<h3>Change the second drone to the adhoc network</h3>

<p>Connect your computer to the second drone&rsquo;s network.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="nv">telnet</span> <span class="mf">192.68</span><span class="nv">.1.1</span>
</span></code></pre></td></tr></table></div></figure>


<p>`</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="c1">; This script should be run on the drone.</span>
</span><span class='line'><span class="c1">; Change the IP address to be difference</span>
</span><span class='line'><span class="c1">; for each drone on the same ad-hoc network</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="nv">killall</span> <span class="nv">udhcpd</span>
</span><span class='line'><span class="nv">ifconfig</span> <span class="nv">ath0</span> <span class="nv">down</span>
</span><span class='line'><span class="nv">iwconfig</span> <span class="nv">ath0</span> <span class="nv">mode</span> <span class="nv">ad-hoc</span> <span class="nv">essid</span> <span class="nv">multidrone_ah</span> <span class="nv">channel</span> <span class="nv">auto</span> <span class="nv">commit</span>
</span><span class='line'><span class="nv">ifconfig</span> <span class="nv">ath0</span> <span class="mf">192.168</span><span class="nv">.1.200</span> <span class="nv">netmask</span> <span class="mf">255.255</span><span class="nv">.255.0</span> <span class="nv">up</span>
</span></code></pre></td></tr></table></div></figure>


<p>`</p>

<p>Run the script.</p>

<h3>On your laptop</h3>

<ul>
<li>Connect to the adhoc network that the drones are on &ldquo;multidrone_ah&rdquo;</li>
<li>Change your computer to a static ip on the network (from network
preferences on mac) something like 192.168.1.101</li>
</ul>


<p>Now you are ready to run the program.  Here is a small example of
sending simple commands:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="nf">drone-initialize</span> <span class="ss">:drone1</span> <span class="s">&quot;192.168.1.100&quot;</span> <span class="nv">default-at-port</span> <span class="nv">default-navdata-port</span><span class="p">)</span>
</span><span class='line'><span class="p">(</span><span class="nf">mdrone</span> <span class="ss">:drone1</span> <span class="ss">:take-off</span><span class="p">)</span>
</span><span class='line'><span class="p">(</span><span class="nf">mdrone</span> <span class="ss">:drone1</span> <span class="ss">:land</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="nf">drone-initialize</span> <span class="ss">:drone2</span> <span class="s">&quot;192.168.1.200&quot;</span> <span class="nv">default-at-port</span> <span class="nv">default-navdata-port</span><span class="p">)</span>
</span><span class='line'><span class="p">(</span><span class="nf">mdrone</span> <span class="ss">:drone2</span> <span class="ss">:take-off</span><span class="p">)</span>
</span><span class='line'><span class="p">(</span><span class="nf">mdrone</span> <span class="ss">:drone2</span> <span class="ss">:land</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>`</p>

<h2>Bring on Multiple Drones interacting with Goals and Beliefs</h2>

<p>The clj-drone library implements goals and beliefs from <a href="http://gigasquid.github.io/blog/2012/09/20/7-john-mccarthy-papers-in-7-weeks-1/">John
McCarthy&rsquo;s work</a>.
The way this works is that the navigation data being constantly sent
to our computer for processing.  Everytime we get a navigation packet
that ends up looking something like this, (but with lots more data):</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'> <span class="p">{</span><span class="ss">:altitude</span> <span class="mf">0.0</span>, <span class="ss">:yaw</span> <span class="mf">-0.215</span>, <span class="ss">:pitch</span> <span class="mf">-1.075</span>, <span class="ss">:roll</span> <span class="mf">-2.904</span>, <span class="ss">:control-state</span> <span class="ss">:landed</span>, <span class="ss">:communication</span> <span class="ss">:ok</span>, <span class="ss">:com-watchdog</span> <span class="ss">:ok</span>, <span class="ss">:seq-num</span> <span class="mi">870</span><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>`</p>

<p>We then define a belief-action using this data.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="nf">def-belief-action</span> <span class="nv">ba-landed1</span>
</span><span class='line'>  <span class="s">&quot;I (Drone1) am landed&quot;</span>
</span><span class='line'>  <span class="p">(</span><span class="k">fn </span><span class="p">[{</span><span class="ss">:keys</span> <span class="p">[</span><span class="nv">control-state</span><span class="p">]}]</span> <span class="p">(</span><span class="nb">= </span><span class="nv">control-state</span> <span class="ss">:landed</span><span class="p">))</span>
</span><span class='line'>  <span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">navdata</span><span class="p">]</span> <span class="p">(</span><span class="nf">mdrone</span> <span class="ss">:drone1</span> <span class="ss">:take-off</span><span class="p">)))</span>
</span></code></pre></td></tr></table></div></figure>


<p>`</p>

<p>The def-belief-action macro takes:</p>

<ul>
<li>Name of the belief action</li>
<li>A readable sentence that expresses the belief.  (This is later
logged, so that we know what the drone believes at all times.)</li>
<li>A predicate that takes in the navigation data as a parameter.  When
it evaluates to true, then the belief is said to be &ldquo;held&rdquo;.</li>
<li>A function to execute when the belief is held</li>
</ul>


<p>The beliefs are then combined to form goals.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="nf">def-goal</span> <span class="nv">g-take-off1</span>
</span><span class='line'>  <span class="s">&quot;I (Drone1) want to fly.&quot;</span>
</span><span class='line'>  <span class="p">(</span><span class="k">fn </span><span class="p">[{</span><span class="ss">:keys</span> <span class="p">[</span><span class="nv">control-state</span><span class="p">]}]</span> <span class="p">(</span><span class="nb">= </span><span class="nv">control-state</span> <span class="ss">:hovering</span><span class="p">))</span>
</span><span class='line'>  <span class="p">[</span><span class="nv">ba-landed1</span> <span class="nv">ba-taking-off1</span><span class="p">])</span>
</span></code></pre></td></tr></table></div></figure>


<p>`</p>

<p>The def-goal macro takes:</p>

<ul>
<li>The name of the goal</li>
<li>A readable sentence that expresses the goal. (This is later logged,
so that we can know when it achieves a goal.)</li>
<li>A predicate that takes in the navigation data as a parameter.  When
it evaluates to true, the goal is said to be achieved.  It will no
longer evaluate or hold any of the belief actions associated with
that goal.</li>
</ul>


<p>Finally, we can set a list of goals for a drone to achieve:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'> <span class="p">(</span><span class="nf">set-current-goal-list</span> <span class="nv">drones</span> <span class="ss">:drone1</span>
</span><span class='line'> <span class="p">[</span><span class="nv">g-take-off1</span> <span class="nv">g-find-other-drone-and-wave1</span> <span class="nv">g-land1</span><span class="p">])</span>
</span></code></pre></td></tr></table></div></figure>


<p>This sets the goal list for a drone.  It will take-off, look around
for the other drone and wave, (do a dance), once it sees it.  Finally,
after both drones have spotted each other and waved, they will both
land.</p>

<h2>Video or It Didn&rsquo;t Happen</h2>

<p>Here is a video of both drones.  They will take off, look around for
each other and wave when they spot each other.  They will land when
the have both waved.  They are operating solely on goals and beliefs
with their navigation data.</p>

<div class="ratio-4-3 embed-video-container" onclick="var myAnchor = document.getElementById('J65rvPdJQ0c');var tmpDiv = document.createElement('div');tmpDiv.innerHTML = '&lt;iframe style=&quot;vertical-align:top;width:100%;height:100%;position:absolute;&quot; src=&quot;http://www.youtube.com/embed/J65rvPdJQ0c?autoplay=1&quot; frameborder=&quot;0&quot; allowfullscreen&gt;&lt;/iframe&gt;';myAnchor.parentNode.replaceChild(tmpDiv.firstChild, myAnchor);return false;" title="click here to play">
<a class="youtube-lazy-link" style="width:100%;height:100%;background:#000 url(http://i2.ytimg.com/vi/J65rvPdJQ0c/0.jpg) center center no-repeat;background-size:contain;position:absolute" href="http://www.youtube.com/watch?v=J65rvPdJQ0c" id="J65rvPdJQ0c" onclick="return false;">
<div class="youtube-lazy-link-div"></div>
<div class="youtube-lazy-link-info">Dual Drone Seek and Dance</div>
</a>
<div class="video-info" >Two drones turn until they see each other. When a drone sees the other, it will do a little dance. When both have danced, they will land.

Programmed by @carinmeier using the clj-drone library with beliefs and goals. (see https://github.com/gigasquid/clj-drone).</div>
</div>


<p>The code running the video above can be found in the examples of the
<a href="https://github.com/gigasquid/clj-drone/tree/master/examples">clj-drone</a>.</p>

<p>Happy Hacking!</p>

		
		
	</div>

<div class="meta">
	
		<span class="comments"><a href="/blog/2013/09/05/controlling-multiple-drones-with-clojure-and-goals-and-beliefs//blog/page/2/index.html#disqus_thread">Comments</a></span>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2013/07/22/5-whys-of-community/">
		
			My 5 Whys of Community</a>
	</h2>
    <div class="entry-content">
    <div class="meta">
      <div class="date">Published on: 








  


<time datetime="2013-07-22T19:44:00-04:00" pubdate data-updated="true">Jul 22<span>nd</span>, 2013</time></div>
      <div class="tags">Tags: 


	<a class='category' href='/blog/categories/community/'>community</a>


</div>
    </div>
		<h2>Why do you devote time and participate in the community?</h2>

<p>1) <em>Why do you devote time and participate in the community?</em></p>

<p>I find joy in coding and making things. I want to be around other
people who feel the same way.</p>

<p>2) <em>Why?</em></p>

<p>Because I want to be inspired by others and learn from others and hope that they are inspired and learn from me.</p>

<p>3) <em>Why?</em></p>

<p>Because ideas and learning doesn&rsquo;t happen in a vacuum. There is something magical about the serendipity of human interaction and that needs a community to take place.</p>

<p>4) <em>Why?</em></p>

<p>It is all fundamentally about people. People dream. We talk about our dreams and get together and make them reality. That is the magic of our civilization.</p>

<p>5) <em>Why?</em></p>

<p>I don&rsquo;t want to dream alone.</p>

<p>What are your reasons?
In response to <a href="http://words.cdmwebs.com/let-s-start-with-why">Let&rsquo;s Start with Why</a></p>

		
		
	</div>

<div class="meta">
	
		<span class="comments"><a href="/blog/2013/07/22/5-whys-of-community//blog/page/2/index.html#disqus_thread">Comments</a></span>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2013/07/15/demoing-with-drones-tips-and-warnings/">
		
			Demoing With Drones: Tips and Warnings</a>
	</h2>
    <div class="entry-content">
    <div class="meta">
      <div class="date">Published on: 








  


<time datetime="2013-07-15T15:42:00-04:00" pubdate data-updated="true">Jul 15<span>th</span>, 2013</time></div>
      <div class="tags">Tags: 


	<a class='category' href='/blog/categories/all/'>All</a>, <a class='category' href='/blog/categories/drone/'>Drone</a>


</div>
    </div>
		<p>Lately, I have had the pleasure of speaking and sharing my experience
of programming <a href="http://ardrone2.parrot.com/">AR Drones</a> with Clojure.  However, doing live hardware
demos has not always been a smooth ride.  In fact, it can be fraught
with peril.  I thought that I would share some of the tips and tricks
that have helped me, as well as help make you
aware of some potential pitfalls.</p>

<h2>Traveling with the AR Drone</h2>

<p><img class="left" src="http://farm6.staticflickr.com/5332/9301848814_1633857d6d.jpg"></p>

<p>Do you need to take your drone with you on the plane to the demo?
The box that the drone comes in is a very nice carrying case, however it
is too big to take on as a carry-on.  I found that taking the hull
off, and packing it into a plastic box worked well.  It was small
enough to pack under the seat of even the smaller planes.  I took the
battery out and packed it in my checked luggage.</p>

<h2>Before the Demo</h2>

<ul>
<li><p><strong>Put colored masking tape on the floor</strong> : If the floor is
  featureless, the drone will have a hard time staying in one place
  while it is hovering.  Put down some strips of colored masking
  tape in the area that you want to demo the drone.</p></li>
<li><p><strong>Charge the spare battery</strong>:  Make sure that you have at least 2
  batteries charged and ready to go.  If there is an extra plug
  nearby, just plug in the battery and charger until you are ready
  to present.</p></li>
<li><p><strong>Beware the network interference</strong>:  In some larger venues, like
  hotels, the network traffic will make things break.  In
  particular, receiving navigation data back from the drone. There
  are possible strategies for mitigating this &ndash; the only one I have
  tried so far is to bump up the timeout on the UDP connection.
  Other things that you may want to try would be to auto-reconnect
  after timeout.  Also limiting the amount navdata you need might
  also work.</p></li>
<li><p><strong>Backup videos</strong> &ndash; Having backup videos of your demo actually
  working is essential.  It is safety net that will allow you to
  sleep the night before.  Like they say, &ldquo;Hope for the best, but
  plan for the worst&rdquo;.</p></li>
<li><p><strong>Rehearse</strong> &ndash; If possible, go through your drone demos in the space
  sometime before the talk.  You will get a feeling for issues that
  might occur &ndash; like network troubles.</p></li>
</ul>


<h2>Demo Time!</h2>

<ul>
<li><p><strong>Front row drone catchers</strong> &ndash; Enlist the aid of your audience.
  Show the people in the front row how to catch a drone safely and
  hold it at a 90 degree angle so the engine cuts out.  That way, if
  the drone starts going off in unplanned ways, you will have help.</p></li>
<li><p><strong>Cross your fingers and have fun</strong> &ndash; Good luck.  Hardware demos are
  a lot of fun.  Hopefully, everything we work as planned, but if
  not &ndash; at least it was interesting.</p></li>
</ul>


		
		
	</div>

<div class="meta">
	
		<span class="comments"><a href="/blog/2013/07/15/demoing-with-drones-tips-and-warnings//blog/page/2/index.html#disqus_thread">Comments</a></span>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2013/06/04/babar-a-little-language-with-speech-acts-for-machines/">
		
			Babar - a Little Language With Speech Acts for Machines</a>
	</h2>
    <div class="entry-content">
    <div class="meta">
      <div class="date">Published on: 








  


<time datetime="2013-06-04T14:57:52-04:00" pubdate data-updated="true">Jun 4<span>th</span>, 2013</time></div>
      <div class="tags">Tags: 


	<a class='category' href='/blog/categories/all/'>All</a>, <a class='category' href='/blog/categories/clojure/'>Clojure</a>, <a class='category' href='/blog/categories/development/'>Development</a>, <a class='category' href='/blog/categories/john-mccarthy-papers/'>John McCarthy Papers</a>, <a class='category' href='/blog/categories/language/'>Language</a>


</div>
    </div>
		<p><img src="http://farm8.staticflickr.com/7352/9925781735_77dfa3157b_o.jpg"></p>

<h2>Preface: A Gentle Obsession</h2>

<p>About a year ago, I picked up John McCarthy&rsquo;s paper on <a href="http://web.archive.org/web/20131014084908/http://www-formal.stanford.edu/jmc/elephant/elephant.html">Elephant 2000</a>. I have to admit that I only understood about 10% of it. But I was so intrigued by the ideas that it sent me on a quest. I re-read it numerous times, slept with it under my pillow, and finally decided that I needed to read his other papers to get an insight into his thoughts. I began a considered effort with <a href="http://gigasquidsoftware.com/blog/2012/09/18/7-john-mccarthy-papers-in-7-days-prologue/">Seven McCarthy Papers in Seven Weeks</a>. It ended up taking about three months, rather than seven 7 weeks. Again I came back to Elephant 2000. I began to understand more as other ideas and concepts sunk in, like <a href="http://web.archive.org/web/20131014084908/http://www-formal.stanford.edu/jmc/ascribing/ascribing.html">ascribing beliefs and goals to machines</a>. But to really explore the ideas, I really wanted to try to implement parts of Elephant in my own programming language. The problem was, having no formal training in computer science, (my background is Physics), I had never created a programming language before. The stars aligned and I found the <a href="https://github.com/Engelberg/instaparse">Instaparse</a> Clojure library. The result is <a href="https://github.com/gigasquid/babar">Babar</a>, a language designed to explore communication with machines via <a href="http://en.wikipedia.org/wiki/Speech_act">Speech Acts</a>.</p>

<h2>What are the Speech Acts?</h2>

<p>When I say say &ldquo;Pass the salt.&rdquo;, the meaning behind the utterance is that I would like someone to reach out and move the salt shaker to me. I am requesting an action be performed. It doesn&rsquo;t really matter if the utterance is in English, French, or Spanish. The intention is the same. Furthermore, if you accept my request to pass the salt. It creates a commitment on your part to actually perform the action. There are two types of speech acts that Babar is concerned with. The first is called an <a href="http://en.wikipedia.org/wiki/Illocutionary_act">Illocutionary Act</a>. Some of the english verbs denoting these acts are &ldquo;assert&rdquo;, &ldquo;command&rdquo;, &ldquo;request&rdquo;, and &ldquo;query&rdquo;. The second is a <a href="http://en.wikipedia.org/wiki/Perlocutionary_act">Perlocutionary Act</a>. These are acts that are concerned with the effects of hearing them on future actions. Some of english verbs denoting these acts are &ldquo;convince&rdquo;, &ldquo;persuade&rdquo;, and &ldquo;warn&rdquo;.</p>

<h2>Hello Babar</h2>

<p>Babar is an experimental language that uses these Speech Acts to communicate. It also combines one of the other ideas of McCarthy, that is of beliefs and goals. The ultimate aim in the language is discover ways of thinking about computers and communicating with them based on the way that we communicate with each other. The state of a computer at any given point in time can be very complex and hard to understand. If we ascribe this state to be a &ldquo;belief&rdquo;, it becomes easier to understand and thus easier to program. The Babar REPL has internal commitments and internal beliefs. The goal of the Babar REPL is to keep all of its commitments. Speech acts are used to &ldquo;convince&rdquo; Babar of beliefs and to make &ldquo;requests&rdquo; that form commitments. The Babar REPL continually checks to see if it needs to fulfill a commitments. It fulfills them based on its beliefs. As an optional configuration, the REPL will speak aloud its beliefs as the become true &ndash; or as it &ldquo;holds&rdquo; the belief.</p>

<h2>Syntax and Basics</h2>

<p>The language uses basic Clojure datatypes and makes the parens optional in most cases to make the expressions look more like syntactically sugared speech acts.</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'>
</span><span class='line'>    <span class="mi">1</span>     <span class="c1">;=&gt; 1</span>
</span><span class='line'>    <span class="mf">2.3</span>   <span class="c1">;=&gt; 2.3</span>
</span><span class='line'>    <span class="mf">-3.4</span>  <span class="c1">;=&gt; 3.4</span>
</span><span class='line'>    <span class="s">&quot;cat&quot;</span> <span class="c1">;=&gt; cat</span>
</span><span class='line'>    <span class="ss">:bird</span> <span class="c1">;=&gt; bird</span>
</span><span class='line'>    <span class="nv">true</span>  <span class="c1">;=&gt; true</span>
</span><span class='line'>    <span class="p">{</span><span class="ss">:cat</span> <span class="ss">:meow</span> <span class="ss">:dog</span> <span class="ss">:bark</span><span class="p">}</span> <span class="c1">;=&gt; {:cat :meow :dog :bark}</span>
</span><span class='line'>    <span class="p">[</span><span class="mi">1</span> <span class="mi">2</span> <span class="nv">true</span> <span class="ss">:bird</span><span class="p">]</span> <span class="c1">;=&gt; [1 2 true bird]</span>
</span><span class='line'>    <span class="nv">atom</span> <span class="mi">1</span> <span class="c1">;=&gt; #</span>
</span><span class='line'>
</span><span class='line'>    <span class="p">(</span><span class="k">def </span><span class="nv">dog</span> <span class="mi">16</span><span class="p">)</span>
</span><span class='line'>    <span class="nv">dog</span> <span class="c1">;=&gt; 16</span>
</span><span class='line'>    <span class="k">def </span><span class="nv">cat</span> <span class="mi">18</span>
</span><span class='line'>    <span class="nv">cat</span> <span class="c1">;=&gt; 18</span>
</span></code></pre></td></tr></table></div></figure>


<p>Vectors are a bit interesting in the respect that you don&rsquo;t need to input the square brackets. If you just put in space delimited items, it will automatically construct a vector for you.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="c1">;=&gt; [1 2 3 4]</span>
</span></code></pre></td></tr></table></div></figure>


<p>`</p>

<p>You can create anonymous functions with the fn [x] syntax from clojure. And call them with surrounding parens. You can call regular functions by the () notation or the shorthand :.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="k">fn </span><span class="p">[</span><span class="nv">x</span><span class="p">]</span> <span class="nb">+ </span><span class="nv">x</span> <span class="mi">1</span> <span class="c1">;=&gt; fn</span>
</span><span class='line'><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">x</span><span class="p">]</span> <span class="nb">+ </span><span class="nv">x</span> <span class="mi">1</span><span class="p">)</span> <span class="c1">;=&gt; fn</span>
</span><span class='line'><span class="p">((</span><span class="k">fn </span><span class="p">[</span><span class="nv">x</span><span class="p">]</span> <span class="nb">+ </span><span class="nv">x</span> <span class="mi">1</span><span class="p">)</span> <span class="mi">3</span><span class="p">)</span> <span class="c1">;=&gt; 4</span>
</span><span class='line'><span class="p">((</span><span class="k">fn </span><span class="p">[</span><span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span><span class="p">]</span> <span class="nb">+ </span><span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span><span class="p">)</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span><span class="p">)</span> <span class="c1">;=&gt; 6</span>
</span><span class='line'><span class="p">((</span><span class="k">fn </span><span class="p">[]</span> <span class="p">[</span><span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span><span class="p">]))</span> <span class="c1">;=&gt; [4 5 6]</span>
</span><span class='line'>
</span><span class='line'><span class="kd">defn </span><span class="nv">dog</span> <span class="p">[]</span> <span class="s">&quot;woof&quot;</span>
</span><span class='line'><span class="nv">dog</span><span class="err">:</span> <span class="c1">;=&gt; &quot;woof&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>`</p>

<p>To see the complete documentation &ndash; please visit the <a href="https://github.com/gigasquid/babar">Github repo</a>.</p>

<h2>Show Me Babar Speech Acts</h2>

<p>Now that we have the basics. Let&rsquo;s look at example of running a program with speech acts.
This one speaks its beliefs and has assertions, a request, and queries.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="nv">speak-config</span> <span class="nv">true.</span>
</span><span class='line'><span class="nb">assert </span><span class="nv">sunny</span> <span class="nv">false.</span>
</span><span class='line'><span class="nv">convince</span> <span class="o">#</span><span class="nv">nice-day</span> <span class="s">&quot;It is a nice day.&quot;</span> <span class="k">fn </span><span class="p">[]</span> <span class="nb">= </span><span class="nv">sunny</span> <span class="nv">true.</span>
</span><span class='line'><span class="nv">request</span> <span class="nv">*open-window</span> <span class="nb">when </span><span class="o">#</span><span class="nv">nice-day</span> <span class="k">fn </span><span class="p">[]</span> <span class="nb">println </span><span class="s">&quot;Opened the window&quot;</span><span class="nv">.</span>
</span><span class='line'><span class="nv">query</span> <span class="nv">request-is-done</span> <span class="nv">*open-window?</span>
</span><span class='line'><span class="nb">assert </span><span class="nv">sunny</span> <span class="nv">true.</span>
</span><span class='line'><span class="nv">query</span> <span class="nv">request-is-done</span> <span class="nv">*open-window?</span>
</span></code></pre></td></tr></table></div></figure>


<p>`</p>

<div class="ratio-4-3 embed-video-container" onclick="var myAnchor = document.getElementById('bt2iYsVyCOM');var tmpDiv = document.createElement('div');tmpDiv.innerHTML = '&lt;iframe style=&quot;vertical-align:top;width:100%;height:100%;position:absolute;&quot; src=&quot;http://www.youtube.com/embed/bt2iYsVyCOM?autoplay=1&quot; frameborder=&quot;0&quot; allowfullscreen&gt;&lt;/iframe&gt;';myAnchor.parentNode.replaceChild(tmpDiv.firstChild, myAnchor);return false;" title="click here to play">
<a class="youtube-lazy-link" style="width:100%;height:100%;background:#000 url(http://i2.ytimg.com/vi/bt2iYsVyCOM/0.jpg) center center no-repeat;background-size:contain;position:absolute" href="http://www.youtube.com/watch?v=bt2iYsVyCOM" id="bt2iYsVyCOM" onclick="return false;">
<div class="youtube-lazy-link-div"></div>
<div class="youtube-lazy-link-info">Babar Speech Acts</div>
</a>
<div class="video-info" >Examples of Speech Acts in the Babar language https://github.com/gigasquid/babar</div>
</div>


<p>Here is another one that shows using a request until a belief is held.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="nv">speak-config</span> <span class="nv">true.</span>
</span><span class='line'>
</span><span class='line'><span class="nb">assert </span><span class="nv">counter</span> <span class="nv">atom</span> <span class="mi">1</span><span class="nv">.</span>
</span><span class='line'><span class="nv">convince</span> <span class="o">#</span><span class="nv">done</span> <span class="s">&quot;I am done counting&quot;</span> <span class="k">fn </span><span class="p">[]</span> <span class="nb">&gt; </span><span class="err">@</span><span class="nv">counter</span> <span class="mi">3</span><span class="nv">.</span>
</span><span class='line'><span class="nv">request</span> <span class="nv">*count-up</span> <span class="nv">until</span> <span class="o">#</span><span class="nv">done</span> <span class="k">fn </span><span class="p">[]</span> <span class="nv">swap!</span> <span class="nv">counter</span> <span class="nv">inc.</span>
</span><span class='line'><span class="nv">sleep</span> <span class="mi">25</span><span class="nv">.</span>
</span><span class='line'><span class="nv">query</span> <span class="nv">request-value</span> <span class="nv">*count-up?</span>
</span></code></pre></td></tr></table></div></figure>


<p>`</p>

<div class="ratio-4-3 embed-video-container" onclick="var myAnchor = document.getElementById('aT8MK0w71LM');var tmpDiv = document.createElement('div');tmpDiv.innerHTML = '&lt;iframe style=&quot;vertical-align:top;width:100%;height:100%;position:absolute;&quot; src=&quot;http://www.youtube.com/embed/aT8MK0w71LM?autoplay=1&quot; frameborder=&quot;0&quot; allowfullscreen&gt;&lt;/iframe&gt;';myAnchor.parentNode.replaceChild(tmpDiv.firstChild, myAnchor);return false;" title="click here to play">
<a class="youtube-lazy-link" style="width:100%;height:100%;background:#000 url(http://i2.ytimg.com/vi/aT8MK0w71LM/0.jpg) center center no-repeat;background-size:contain;position:absolute" href="http://www.youtube.com/watch?v=aT8MK0w71LM" id="aT8MK0w71LM" onclick="return false;">
<div class="youtube-lazy-link-div"></div>
<div class="youtube-lazy-link-info">Babar Speech Acts - using requests and until</div>
</a>
<div class="video-info" >An example of Babar speech acts using requests until a belief is held.

https://github.com/gigasquid/babar</div>
</div>


<p>Here the REPL asks you a question if you give it an undeclared var</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="nv">speak-config</span> <span class="nv">true.</span>
</span><span class='line'><span class="nv">ask-config</span> <span class="nv">true.</span>
</span><span class='line'>
</span><span class='line'><span class="nv">request</span> <span class="nv">*task1</span> <span class="k">fn </span><span class="p">[]</span> <span class="nb">+ </span><span class="mi">10</span> <span class="nv">x.</span>
</span><span class='line'><span class="nv">query</span> <span class="nv">request-is-done</span> <span class="nv">*task1?</span>
</span><span class='line'><span class="nb">assert </span><span class="nv">x</span> <span class="mi">3</span><span class="nv">.</span>
</span><span class='line'><span class="nv">sleep</span> <span class="mi">10</span><span class="nv">.</span>
</span><span class='line'><span class="nv">query</span> <span class="nv">request-is-done</span> <span class="nv">*task1?</span>
</span><span class='line'><span class="nv">query</span> <span class="nv">request-value</span> <span class="nv">*task1?</span>
</span></code></pre></td></tr></table></div></figure>


<p>`</p>

<div class="ratio-4-3 embed-video-container" onclick="var myAnchor = document.getElementById('nmi_fafmjsg');var tmpDiv = document.createElement('div');tmpDiv.innerHTML = '&lt;iframe style=&quot;vertical-align:top;width:100%;height:100%;position:absolute;&quot; src=&quot;http://www.youtube.com/embed/nmi_fafmjsg?autoplay=1&quot; frameborder=&quot;0&quot; allowfullscreen&gt;&lt;/iframe&gt;';myAnchor.parentNode.replaceChild(tmpDiv.firstChild, myAnchor);return false;" title="click here to play">
<a class="youtube-lazy-link" style="width:100%;height:100%;background:#000 url(http://i2.ytimg.com/vi/nmi_fafmjsg/0.jpg) center center no-repeat;background-size:contain;position:absolute" href="http://www.youtube.com/watch?v=nmi_fafmjsg" id="nmi_fafmjsg" onclick="return false;">
<div class="youtube-lazy-link-div"></div>
<div class="youtube-lazy-link-info">Babar asking you a question</div>
</a>
<div class="video-info" >An example of the speech acts in Babar.  In this example, the REPL asks you a question about what an undeclared var should be.

https://github.com/gigasquid/babar</div>
</div>


<h2>Autonomous AR Drone Flight with Babar REPL</h2>

<p>Since the language is aimed at communincating with machines. It is only natural that I use it to talk to the AR Drone.
Here is a program that has the drone take off, get to a cruising altitude, and land &ndash; all using speech acts (and the <a href="https://github.com/gigasquid/clj-drone">clj-drone library</a>).</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="nv">speak-config</span> <span class="nv">true.</span>
</span><span class='line'>
</span><span class='line'><span class="nb">import </span><span class="s">&quot;clj-drone.core&quot;</span><span class="nv">.</span>
</span><span class='line'><span class="nb">import </span><span class="s">&quot;clj-drone.navdata&quot;</span><span class="nv">.</span>
</span><span class='line'>
</span><span class='line'><span class="nb">assert </span><span class="nv">get-navdata</span> <span class="p">[</span><span class="nv">key</span><span class="p">]</span> <span class="nb">get </span><span class="err">@</span><span class="nv">nav-data</span> <span class="nv">key.</span>
</span><span class='line'><span class="nb">assert </span><span class="nv">navdata-equal</span> <span class="p">[</span><span class="nb">key </span><span class="nv">val</span><span class="p">]</span> <span class="nb">= </span><span class="p">(</span><span class="nf">get-navdata</span> <span class="nv">key</span><span class="p">)</span> <span class="nv">val.</span>
</span><span class='line'><span class="nb">assert </span><span class="nv">navdata-gt</span> <span class="p">[</span><span class="nb">key </span><span class="nv">val</span><span class="p">]</span> <span class="nb">&gt; </span><span class="p">(</span><span class="nf">get-navdata</span> <span class="nv">key</span><span class="p">)</span> <span class="nv">val.</span>
</span><span class='line'><span class="nb">assert </span><span class="nv">init-drone</span> <span class="p">[]</span> <span class="p">(</span><span class="nf">drone-initialize</span><span class="p">)</span><span class="nv">.</span>
</span><span class='line'><span class="nb">assert </span><span class="nv">init-nav</span> <span class="p">[]</span> <span class="p">(</span><span class="nf">drone-init-navdata</span><span class="p">)</span><span class="nv">.</span>
</span><span class='line'>
</span><span class='line'><span class="nv">convince</span> <span class="o">#</span><span class="nv">landed</span> <span class="s">&quot;I am on the ground&quot;</span> <span class="k">fn </span><span class="p">[]</span> <span class="p">(</span><span class="nf">navdata-equal</span> <span class="ss">:control-state</span> <span class="ss">:landed</span><span class="p">)</span><span class="nv">.</span>
</span><span class='line'><span class="nv">convince</span> <span class="o">#</span><span class="nv">flying</span> <span class="s">&quot;I am flying&quot;</span> <span class="k">fn </span><span class="p">[]</span> <span class="nb">or </span><span class="p">(</span><span class="nf">navdata-equal</span> <span class="ss">:control-state</span> <span class="ss">:flying</span><span class="p">)</span>
</span><span class='line'>                                        <span class="p">(</span><span class="nf">navdata-equal</span> <span class="ss">:control-state</span> <span class="ss">:hovering</span><span class="p">)</span><span class="nv">.</span>
</span><span class='line'><span class="nv">convince</span> <span class="o">#</span><span class="nv">high-enough</span> <span class="s">&quot;I am high enough&quot;</span> <span class="k">fn </span><span class="p">[]</span> <span class="p">(</span><span class="nf">navdata-gt</span> <span class="ss">:altitude</span> <span class="mf">1.5</span><span class="p">)</span><span class="nv">.</span>
</span><span class='line'>
</span><span class='line'><span class="nv">request</span> <span class="nv">*take-off</span> <span class="nb">when </span><span class="o">#</span><span class="nv">landed</span> <span class="k">fn </span><span class="p">[]</span> <span class="p">(</span><span class="nf">drone</span> <span class="ss">:take-off</span><span class="p">)</span><span class="nv">.</span>
</span><span class='line'><span class="nv">request</span> <span class="nv">*cruising-alt</span> <span class="nb">when </span><span class="o">#</span><span class="nv">flying</span> <span class="nv">until</span> <span class="o">#</span><span class="nv">high-enough</span> <span class="k">fn </span><span class="p">[]</span> <span class="p">(</span><span class="nf">drone</span> <span class="ss">:up</span> <span class="mf">0.1</span><span class="p">)</span><span class="nv">.</span>
</span><span class='line'><span class="nv">request</span> <span class="nv">*land</span> <span class="nb">when </span><span class="o">#</span><span class="nv">high-enough</span> <span class="k">fn </span><span class="p">[]</span> <span class="p">(</span><span class="nf">drone</span> <span class="ss">:land</span><span class="p">)</span><span class="nv">.</span>
</span><span class='line'>
</span><span class='line'><span class="nv">convince</span> <span class="o">#</span><span class="nv">done</span> <span class="s">&quot;Whee! I am done.&quot;</span> <span class="k">fn </span><span class="p">[]</span> <span class="nb">and </span><span class="p">(</span><span class="nf">navdata-equal</span> <span class="ss">:control-state</span> <span class="ss">:landed</span><span class="p">)</span>
</span><span class='line'>                                            <span class="nv">query</span> <span class="nv">request-is-done</span> <span class="nv">*land.</span>
</span><span class='line'><span class="nv">request</span> <span class="nv">*end-navstream</span> <span class="nb">when </span><span class="o">#</span><span class="nv">done</span> <span class="k">fn </span><span class="p">[]</span> <span class="p">(</span><span class="nf">end-navstream</span><span class="p">)</span><span class="nv">.</span>
</span></code></pre></td></tr></table></div></figure>


<p>`</p>

<div class="ratio-4-3 embed-video-container" onclick="var myAnchor = document.getElementById('CIzR8jD2d3c');var tmpDiv = document.createElement('div');tmpDiv.innerHTML = '&lt;iframe style=&quot;vertical-align:top;width:100%;height:100%;position:absolute;&quot; src=&quot;http://www.youtube.com/embed/CIzR8jD2d3c?autoplay=1&quot; frameborder=&quot;0&quot; allowfullscreen&gt;&lt;/iframe&gt;';myAnchor.parentNode.replaceChild(tmpDiv.firstChild, myAnchor);return false;" title="click here to play">
<a class="youtube-lazy-link" style="width:100%;height:100%;background:#000 url(http://i2.ytimg.com/vi/CIzR8jD2d3c/0.jpg) center center no-repeat;background-size:contain;position:absolute" href="http://www.youtube.com/watch?v=CIzR8jD2d3c" id="CIzR8jD2d3c" onclick="return false;">
<div class="youtube-lazy-link-div"></div>
<div class="youtube-lazy-link-info">Flying an AR Drone with Babar Speech Acts</div>
</a>
<div class="video-info" >In this example, we import the clojure clj-drone library https://github.com/gigasquid/clj-drone, and use it to have the drone autonomously fly, get to a cruising altitude and land - all while vocalizing its beliefs.

https://github.com/gigasquid/babar</div>
</div>


<h2>Conclusion and Thanks</h2>

<p>I can honestly say, that this has been one of the most enjoyable programming quests. I encourage you all to look at McCarthy&rsquo;s papers, Clojure, Instaparse, and of course, hacking robots. A special thanks to all the Cincy folks at <a href="http://www.neo.com/">Neo</a> who have supported me through my gentle obsessions and have let me have the freedom to follow my curiosity.</p>

		
		
	</div>

<div class="meta">
	
		<span class="comments"><a href="/blog/2013/06/04/babar-a-little-language-with-speech-acts-for-machines//blog/page/2/index.html#disqus_thread">Comments</a></span>
	
</div>
</article>

<nav id="pagenavi">
    
        <a href="/" class="prev">Prev</a>
    
    
        <a href="/blog/page/3/" class="next">Next</a>
    
    <div class="center"><a href="/blog/archives">Blog Archives</a></div>
</nav>

    </div>
    <footer id="footer">
    <div style="display:inline">
    Copyright &copy; 2014

    Carin Meier
. Powered by <a href="http://octopress.org">Octopress</a> | 
    Theme <a href="http://github.com/panks/fabric">fabric</a> by <a href="http://panks.me">Pankaj Kumar</a>
</div>


    </footer>
    <script src="/javascripts/fabric.js"></script>
<script src="/javascripts/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
	$('.fancybox').fancybox();
})(jQuery);
</script> <!-- Delete or comment this line to disable Fancybox -->


<script type="text/javascript">
      var disqus_shortname = 'squidsblog';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>





<!-- end toload --> 
</div>
</div>
<script src="/javascripts/jquery.ui.totop.js" type="text/javascript"></script>
<script type="text/javascript">
/*<![CDATA[*/
;(function($){$().UItoTop({easingType:'easeOutCirc'});})(jQuery); 
/*]]>*/
</script><!-- remove it to remove the scroll to top button -->
</body>
</html>
